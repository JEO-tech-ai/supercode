{
  "version": 3,
  "sources": ["../../src/cli/index.ts", "../../src/config/loader.ts", "../../src/config/schema.ts", "../../src/cli/commands/auth.ts", "../../src/services/auth/claude.ts", "../../src/server/store/token-store.ts", "../../src/shared/logger.ts", "../../src/services/auth/codex.ts", "../../src/services/auth/gemini.ts", "../../src/server/store/oauth-state-store.ts", "../../node_modules/@hono/node-server/dist/index.mjs", "../../src/server/index.ts", "../../src/server/routes/index.ts", "../../src/server/routes/health.ts", "../../src/server/routes/auth-callback.ts", "../../src/services/auth/hub.ts", "../../src/cli/commands/models.ts", "../../src/shared/errors.ts", "../../src/services/models/providers/anthropic.ts", "../../src/services/models/providers/openai.ts", "../../src/services/models/providers/google.ts", "../../src/services/models/router.ts", "../../src/cli/commands/server.ts", "../../src/cli/commands/config.ts", "../../src/cli/commands/doctor.ts", "../../src/cli/commands/dashboard.ts", "../../src/services/agents/todo-manager.ts", "../../src/core/session.ts", "../../src/config/opencode.ts", "../../src/services/models/ai-sdk/registry.ts", "../../src/services/models/ai-sdk/stream.ts"],
  "sourcesContent": ["import * as clack from \"@clack/prompts\";\nimport { Command } from \"commander\";\nimport { loadConfig } from \"../config/loader.js\";\nimport { createAuthCommand } from \"./commands/auth\";\nimport { createModelsCommand } from \"./commands/models\";\nimport { createServerCommand } from \"./commands/server\";\nimport { createConfigCommand } from \"./commands/config\";\nimport { createDoctorCommand } from \"./commands/doctor\";\nimport { createDashboardCommand } from \"./commands/dashboard\";\nimport { resolveProviderFromConfig } from \"../config/opencode\";\nimport { streamAIResponse, checkLocalhostAvailability } from \"../services/models/ai-sdk\";\nimport type { AISDKProviderName } from \"../services/models/ai-sdk/types\";\nimport logger from \"../shared/logger\";\n\nconst VERSION = \"0.1.0\";\n\nasync function runInteractiveMode() {\n  clack.intro(\"\uD83E\uDE99 SuperCoin - Unified AI CLI Hub\");\n\n  const action = await clack.select({\n    message: \"What would you like to do?\",\n    options: [\n      { value: \"chat\", label: \"\uD83D\uDCAC Start Chat\", hint: \"Chat with AI models\" },\n      { value: \"auth\", label: \"\uD83D\uDD10 Authentication\", hint: \"Manage provider authentication\" },\n      { value: \"models\", label: \"\uD83E\uDD16 Models\", hint: \"List and manage AI models\" },\n      { value: \"config\", label: \"\u2699\uFE0F  Configuration\", hint: \"View and edit settings\" },\n      { value: \"server\", label: \"\uD83C\uDF10 Server\", hint: \"Manage local auth server\" },\n      { value: \"doctor\", label: \"\uD83E\uDE7A Doctor\", hint: \"Run system diagnostics\" },\n      { value: \"dashboard\", label: \"\uD83D\uDCCA Dashboard\", hint: \"View agent status and progress\" },\n    ],\n  });\n\n  if (clack.isCancel(action)) {\n    clack.cancel(\"Operation cancelled\");\n    process.exit(0);\n  }\n\n  switch (action) {\n    case \"chat\":\n      await runChatFlow();\n      break;\n    case \"auth\":\n      await runAuthFlow();\n      break;\n    case \"models\":\n      await runModelsFlow();\n      break;\n    case \"config\":\n      await runConfigFlow();\n      break;\n    case \"server\":\n      await runServerFlow();\n      break;\n    case \"doctor\":\n      await runDoctorFlow();\n      break;\n    case \"dashboard\":\n      await runDashboardFlow();\n      break;\n  }\n\n  clack.outro(\"\u2728 Done!\");\n}\n\nasync function runChatFlow() {\n  const projectConfig = await resolveProviderFromConfig();\n\n  const provider = await clack.select({\n    message: \"Select AI provider\",\n    options: [\n      { value: \"ollama\", label: \"\uD83E\uDD99 Ollama (Local)\", hint: \"Privacy-first, cost-free\" },\n      { value: \"lmstudio\", label: \"\uD83D\uDCBB LM Studio (Local)\", hint: \"Run models locally\" },\n      { value: \"llamacpp\", label: \"\uD83D\uDD27 llama.cpp (Local)\", hint: \"Raw performance\" },\n      { value: \"anthropic\", label: \"\uD83E\uDD16 Claude (Anthropic)\", hint: \"Requires API key\" },\n      { value: \"openai\", label: \"\u26A1 Codex (OpenAI)\", hint: \"Requires API key\" },\n      { value: \"google\", label: \"\uD83D\uDD2E Gemini (Google)\", hint: \"Requires API key or OAuth\" },\n    ],\n    initialValue: projectConfig.provider as AISDKProviderName,\n  });\n\n  if (clack.isCancel(provider)) {\n    clack.cancel(\"Operation cancelled\");\n    return;\n  }\n\n  const isLocalhost = [\"ollama\", \"lmstudio\", \"llamacpp\"].includes(provider);\n\n  if (isLocalhost) {\n    const s = clack.spinner();\n    s.start(`Checking ${provider} availability...`);\n    \n    const available = await checkLocalhostAvailability(\n      provider as \"ollama\" | \"lmstudio\" | \"llamacpp\",\n      projectConfig.baseURL\n    );\n    \n    if (!available) {\n      s.stop(`${provider} is not available`);\n      clack.log.error(`Please start ${provider} first.`);\n      \n      if (provider === \"ollama\") {\n        clack.log.info(\"Install: curl -fsSL https://ollama.com/install.sh | sh\");\n        clack.log.info(\"Run: ollama pull llama3\");\n      }\n      return;\n    }\n    \n    s.stop(`${provider} is ready`);\n  }\n\n  let model = projectConfig.model;\n  \n  const customizeModel = await clack.confirm({\n    message: \"Customize model?\",\n    initialValue: false,\n  });\n\n  if (clack.isCancel(customizeModel)) {\n    clack.cancel(\"Operation cancelled\");\n    return;\n  }\n\n  if (customizeModel) {\n    const modelInput = await clack.text({\n      message: \"Model name\",\n      placeholder: model,\n      defaultValue: model,\n    });\n\n    if (clack.isCancel(modelInput)) {\n      clack.cancel(\"Operation cancelled\");\n      return;\n    }\n\n    model = modelInput;\n  }\n\n  const prompt = await clack.text({\n    message: \"Your prompt\",\n    placeholder: \"Ask me anything...\",\n    validate: (value) => {\n      if (!value) return \"Prompt is required\";\n    },\n  });\n\n  if (clack.isCancel(prompt)) {\n    clack.cancel(\"Operation cancelled\");\n    return;\n  }\n\n  const s = clack.spinner();\n  s.start(`${provider} (${model}) is thinking...`);\n\n  console.log();\n\n  try {\n    const result = await streamAIResponse({\n      provider: provider as AISDKProviderName,\n      model,\n      baseURL: projectConfig.baseURL,\n      temperature: projectConfig.temperature,\n      maxTokens: projectConfig.maxTokens,\n      messages: [{ role: \"user\", content: prompt }],\n      onChunk: (text) => process.stdout.write(text),\n    });\n\n    console.log(\"\\n\");\n    s.stop(\"Complete\");\n\n    if (result.usage) {\n      clack.log.info(\n        `Tokens: ${result.usage.promptTokens} in / ${result.usage.completionTokens} out`\n      );\n    }\n  } catch (error) {\n    s.stop(\"Failed\");\n    clack.log.error((error as Error).message);\n  }\n}\n\nasync function runAuthFlow() {\n  const authAction = await clack.select({\n    message: \"Authentication action\",\n    options: [\n      { value: \"status\", label: \"\uD83D\uDCCA Status\", hint: \"Check authentication status\" },\n      { value: \"login\", label: \"\uD83D\uDD11 Login\", hint: \"Login to a provider\" },\n      { value: \"logout\", label: \"\uD83D\uDEAA Logout\", hint: \"Logout from providers\" },\n      { value: \"refresh\", label: \"\uD83D\uDD04 Refresh\", hint: \"Refresh OAuth tokens\" },\n    ],\n  });\n\n  if (clack.isCancel(authAction)) {\n    clack.cancel(\"Operation cancelled\");\n    return;\n  }\n\n  clack.log.info(`Run: supercoin auth ${authAction} --help`);\n  clack.note(\"Use command-line for auth operations\", \"Authentication\");\n}\n\nasync function runModelsFlow() {\n  clack.log.info(\"Run: supercoin models list\");\n  clack.note(\"Use command-line for model operations\", \"Models\");\n}\n\nasync function runConfigFlow() {\n  clack.log.info(\"Run: supercoin config show\");\n  clack.note(\"Use command-line for config operations\", \"Configuration\");\n}\n\nasync function runServerFlow() {\n  clack.log.info(\"Run: supercoin server start\");\n  clack.note(\"Use command-line for server operations\", \"Server\");\n}\n\nasync function runDoctorFlow() {\n  clack.log.info(\"Run: supercoin doctor\");\n  clack.note(\"Use command-line for diagnostics\", \"Doctor\");\n}\n\nasync function runDashboardFlow() {\n  clack.log.info(\"Run: supercoin dashboard\");\n  clack.note(\"Use command-line for dashboard\", \"Dashboard\");\n}\n\nasync function main() {\n  const program = new Command();\n  const config = await loadConfig();\n\n  program\n    .name(\"supercoin\")\n    .description(\"Unified AI CLI hub for Claude, Codex, Gemini, and localhost models\")\n    .version(VERSION)\n    .option(\"-p, --provider <name>\", \"AI provider (anthropic|openai|google|ollama|lmstudio|llamacpp)\")\n    .option(\"-m, --model <id>\", \"AI model to use\")\n    .option(\"-t, --temperature <number>\", \"Temperature setting\", parseFloat)\n    .option(\"--max-tokens <number>\", \"Maximum tokens\", parseInt)\n    .option(\"--base-url <url>\", \"Base URL for localhost providers\")\n    .option(\"--no-tui\", \"Disable interactive UI\")\n    .option(\"--json\", \"Output as JSON\")\n    .option(\"-v, --verbose\", \"Verbose output\")\n    .option(\"-q, --quiet\", \"Minimal output\");\n\n  program.addCommand(createAuthCommand(config));\n  program.addCommand(createModelsCommand(config));\n  program.addCommand(createServerCommand(config));\n  program.addCommand(createConfigCommand(config));\n  program.addCommand(createDoctorCommand(config));\n  program.addCommand(createDashboardCommand(config));\n\n  program\n    .argument(\"[prompt...]\", \"Prompt for AI\")\n    .action(async (promptParts: string[], options) => {\n      const prompt = promptParts.join(\" \");\n\n      if (!prompt && options.tui !== false) {\n        await runInteractiveMode();\n        return;\n      }\n\n      if (!prompt) {\n        program.help();\n        return;\n      }\n\n      try {\n        const projectConfig = await resolveProviderFromConfig();\n        \n        const provider = (options.provider || projectConfig.provider) as AISDKProviderName;\n        const model = options.model || projectConfig.model;\n        const temperature = options.temperature ?? projectConfig.temperature;\n        const maxTokens = options.maxTokens ?? projectConfig.maxTokens;\n        const baseURL = options.baseUrl || projectConfig.baseURL;\n\n        const isLocalhost = [\"ollama\", \"lmstudio\", \"llamacpp\"].includes(provider);\n        \n        if (isLocalhost) {\n          const available = await checkLocalhostAvailability(\n            provider as \"ollama\" | \"lmstudio\" | \"llamacpp\",\n            baseURL\n          );\n          if (!available) {\n            logger.error(`${provider} is not available. Make sure it's running.`);\n            process.exit(1);\n          }\n        }\n\n        if (!options.quiet) {\n          logger.info(`Provider: ${provider} | Model: ${model}`);\n        }\n\n        const result = await streamAIResponse({\n          provider,\n          model,\n          baseURL,\n          temperature,\n          maxTokens,\n          messages: [{ role: \"user\", content: prompt }],\n          onChunk: (text) => process.stdout.write(text),\n        });\n\n        console.log();\n\n        if (options.verbose && result.usage) {\n          logger.info(\n            `Tokens: ${result.usage.promptTokens} in / ${result.usage.completionTokens} out`\n          );\n        }\n      } catch (error) {\n        logger.error(\"Chat failed\", error as Error);\n        process.exit(1);\n      }\n    });\n\n  await program.parseAsync(process.argv);\n}\n\nmain().catch((error) => {\n  logger.error(\"Fatal error\", error);\n  process.exit(1);\n});\n", "/**\n * Configuration Loader\n * Loads and merges configuration from multiple sources\n */\nimport { readFile } from \"fs/promises\";\nimport { existsSync } from \"fs\";\nimport path from \"path\";\nimport { SuperCoinConfigSchema, type SuperCoinConfig } from \"./schema\";\n\nconst CONFIG_FILENAME = \"config.json\";\n\n/**\n * Deep merge two objects\n */\nfunction deepMerge<T extends Record<string, unknown>>(target: T, source: Partial<T>): T {\n  const result = { ...target };\n\n  for (const key in source) {\n    const sourceValue = source[key];\n    const targetValue = target[key];\n\n    if (\n      sourceValue !== null &&\n      typeof sourceValue === \"object\" &&\n      !Array.isArray(sourceValue) &&\n      targetValue !== null &&\n      typeof targetValue === \"object\" &&\n      !Array.isArray(targetValue)\n    ) {\n      result[key] = deepMerge(\n        targetValue as Record<string, unknown>,\n        sourceValue as Record<string, unknown>\n      ) as T[Extract<keyof T, string>];\n    } else if (sourceValue !== undefined) {\n      result[key] = sourceValue as T[Extract<keyof T, string>];\n    }\n  }\n\n  return result;\n}\n\n/**\n * Try to read and parse a JSON config file\n */\nasync function tryReadConfig(filePath: string): Promise<Record<string, unknown> | null> {\n  if (!existsSync(filePath)) {\n    return null;\n  }\n\n  try {\n    const content = await readFile(filePath, \"utf-8\");\n    // Support JSONC (JSON with comments)\n    const cleaned = content\n      .replace(/\\/\\/.*$/gm, \"\") // Remove single-line comments\n      .replace(/\\/\\*[\\s\\S]*?\\*\\//g, \"\"); // Remove multi-line comments\n    return JSON.parse(cleaned);\n  } catch (error) {\n    console.error(`Error reading config from ${filePath}:`, error);\n    return null;\n  }\n}\n\n/**\n * Get configuration file paths\n */\nfunction getConfigPaths(directory?: string): string[] {\n  const paths: string[] = [];\n\n  // User-level config\n  const home = process.env.HOME || process.env.USERPROFILE || \"\";\n  if (home) {\n    paths.push(path.join(home, \".config\", \"supercoin\", CONFIG_FILENAME));\n  }\n\n  // Project-level config\n  const projectDir = directory || process.cwd();\n  paths.push(path.join(projectDir, \".supercoin\", CONFIG_FILENAME));\n\n  return paths;\n}\n\n/**\n * Load configuration from all sources\n */\nexport async function loadConfig(directory?: string): Promise<SuperCoinConfig> {\n  const configPaths = getConfigPaths(directory);\n  let mergedConfig: Record<string, unknown> = {};\n\n  // Load and merge configs (later files override earlier ones)\n  for (const configPath of configPaths) {\n    const config = await tryReadConfig(configPath);\n    if (config) {\n      mergedConfig = deepMerge(mergedConfig, config);\n    }\n  }\n\n  // Validate and return\n  const result = SuperCoinConfigSchema.safeParse(mergedConfig);\n\n  if (!result.success) {\n    console.error(\"Configuration validation errors:\", result.error.errors);\n    // Return defaults on error\n    return SuperCoinConfigSchema.parse({});\n  }\n\n  return result.data;\n}\n\n/**\n * Get default configuration\n */\nexport function getDefaultConfig(): SuperCoinConfig {\n  return SuperCoinConfigSchema.parse({});\n}\n", "import { z } from \"zod\";\n\nconst LocalhostProviderSchema = z.object({\n  enabled: z.boolean().default(true),\n  baseUrl: z.string().default(\"http://localhost:11434/v1\"),\n  defaultModel: z.string().optional(),\n});\n\nexport const SuperCoinConfigSchema = z.object({\n  default_model: z.string().default(\"anthropic/claude-sonnet-4-5\"),\n  fallback_models: z.array(z.string()).default([]),\n  providers: z.object({\n    anthropic: z.object({\n      enabled: z.boolean().default(true),\n      apiKey: z.string().optional(),\n      baseUrl: z.string().url().default(\"https://api.anthropic.com\"),\n    }).optional(),\n    openai: z.object({\n      enabled: z.boolean().default(true),\n      apiKey: z.string().optional(),\n      baseUrl: z.string().url().default(\"https://api.openai.com\"),\n    }).optional(),\n    google: z.object({\n      enabled: z.boolean().default(true),\n      apiKey: z.string().optional(),\n      clientId: z.string().optional(),\n      clientSecret: z.string().optional(),\n      baseUrl: z.string().url().default(\"https://generativelanguage.googleapis.com\"),\n    }).optional(),\n    ollama: LocalhostProviderSchema.extend({\n      baseUrl: z.string().default(\"http://localhost:11434/v1\"),\n      defaultModel: z.string().default(\"llama3.2\"),\n    }).optional(),\n    lmstudio: LocalhostProviderSchema.extend({\n      baseUrl: z.string().default(\"http://localhost:1234/v1\"),\n      defaultModel: z.string().default(\"local-model\"),\n    }).optional(),\n    llamacpp: LocalhostProviderSchema.extend({\n      baseUrl: z.string().default(\"http://localhost:8080/v1\"),\n      defaultModel: z.string().default(\"local-model\"),\n    }).optional(),\n  }).optional(),\n  agents: z.record(z.object({\n    model: z.string().optional(),\n    disabled: z.boolean().optional(),\n  })).optional(),\n  disabled_hooks: z.array(z.string()).default([]),\n  server: z.object({\n    port: z.number().int().min(1).max(65535).default(3100),\n    host: z.string().default(\"127.0.0.1\"),\n    autoStart: z.boolean().default(true),\n  }).optional(),\n});\n\nexport type SuperCoinConfig = z.infer<typeof SuperCoinConfigSchema>;\n\nexport function getDefaultConfig(): SuperCoinConfig {\n  return {\n    default_model: \"anthropic/claude-sonnet-4-5\",\n    fallback_models: [],\n    providers: {\n      anthropic: {\n        enabled: true,\n        baseUrl: \"https://api.anthropic.com\",\n      },\n    },\n    disabled_hooks: [],\n    server: {\n      port: 3100,\n      host: \"127.0.0.1\",\n      autoStart: true,\n    },\n  };\n}\n", "/**\n * Auth Command\n * Manage authentication for AI providers\n */\nimport { Command } from \"commander\";\nimport * as clack from \"@clack/prompts\";\nimport type { SuperCoinConfig } from \"../../config/schema\";\nimport { getAuthHub, type AuthProviderName, type AuthStatus } from \"../../services/auth\";\nimport logger from \"../../shared/logger\";\n\nexport function createAuthCommand(config: SuperCoinConfig): Command {\n  const auth = new Command(\"auth\")\n    .description(\"Manage authentication for AI providers\");\n\n  const authHub = getAuthHub();\n\n  // Login command\n  auth\n    .command(\"login\")\n    .description(\"Authenticate with AI providers\")\n    .option(\"--claude\", \"Login to Claude (Anthropic)\")\n    .option(\"--codex\", \"Login to Codex (OpenAI)\")\n    .option(\"--gemini\", \"Login to Gemini (Google)\")\n    .option(\"--api-key <key>\", \"Provide API key directly\")\n    .option(\"--no-tui\", \"Disable interactive prompts\")\n    .action(async (options) => {\n      const providers: AuthProviderName[] = [];\n\n      if (options.claude) providers.push(\"claude\");\n      if (options.codex) providers.push(\"codex\");\n      if (options.gemini) providers.push(\"gemini\");\n\n      // If no specific provider, show interactive selection\n      if (providers.length === 0 && options.tui !== false) {\n        clack.intro(\"SuperCoin Authentication\");\n\n        const selected = await clack.multiselect({\n          message: \"Select providers to authenticate:\",\n          options: [\n            { value: \"claude\", label: \"Claude (Anthropic)\", hint: \"API Key\" },\n            { value: \"codex\", label: \"Codex (OpenAI)\", hint: \"API Key\" },\n            { value: \"gemini\", label: \"Gemini (Google)\", hint: \"OAuth with Antigravity\" },\n          ],\n          required: true,\n        });\n\n        if (clack.isCancel(selected)) {\n          clack.cancel(\"Authentication cancelled\");\n          process.exit(0);\n        }\n\n        providers.push(...(selected as AuthProviderName[]));\n      }\n\n      // Login to each provider\n      for (const provider of providers) {\n        const s = clack.spinner();\n        s.start(`Authenticating with ${provider}...`);\n\n        try {\n          const results = await authHub.login(provider, {\n            apiKey: options.apiKey,\n            interactive: options.tui !== false,\n          });\n\n          const result = results[0];\n          if (result.success) {\n            s.stop(`Successfully authenticated with ${provider}`);\n          } else {\n            s.stop(`Failed to authenticate with ${provider}: ${result.error}`);\n          }\n        } catch (error) {\n          s.stop(`Failed to authenticate with ${provider}`);\n          logger.error(`Auth error for ${provider}`, error as Error);\n        }\n      }\n\n      // Show final status\n      console.log(\"\");\n      await showAuthStatus(authHub);\n\n      clack.outro(\"Authentication complete!\");\n    });\n\n  // Status command\n  auth\n    .command(\"status\")\n    .description(\"Show authentication status\")\n    .option(\"--json\", \"Output as JSON\")\n    .action(async (options) => {\n      const statuses = await authHub.status();\n\n      if (options.json) {\n        console.log(JSON.stringify(statuses, null, 2));\n        return;\n      }\n\n      await showAuthStatus(authHub);\n    });\n\n  // Refresh command\n  auth\n    .command(\"refresh\")\n    .description(\"Refresh authentication tokens\")\n    .option(\"--claude\", \"Refresh Claude token\")\n    .option(\"--codex\", \"Refresh Codex token\")\n    .option(\"--gemini\", \"Refresh Gemini token\")\n    .action(async (options) => {\n      const providers: AuthProviderName[] = [];\n\n      if (options.claude) providers.push(\"claude\");\n      if (options.codex) providers.push(\"codex\");\n      if (options.gemini) providers.push(\"gemini\");\n\n      // If no specific provider, refresh all\n      if (providers.length === 0) {\n        providers.push(\"claude\", \"codex\", \"gemini\");\n      }\n\n      for (const provider of providers) {\n        const s = clack.spinner();\n        s.start(`Refreshing ${provider} token...`);\n\n        try {\n          const results = await authHub.refresh(provider);\n          const result = results[0];\n\n          if (result.success) {\n            s.stop(`${provider} token refreshed`);\n          } else {\n            s.stop(`${provider}: ${result.error || \"Already up to date\"}`);\n          }\n        } catch (error) {\n          s.stop(`${provider}: ${(error as Error).message}`);\n        }\n      }\n    });\n\n  // Logout command\n  auth\n    .command(\"logout\")\n    .description(\"Logout from AI providers\")\n    .option(\"--claude\", \"Logout from Claude\")\n    .option(\"--codex\", \"Logout from Codex\")\n    .option(\"--gemini\", \"Logout from Gemini\")\n    .option(\"--all\", \"Logout from all providers\")\n    .action(async (options) => {\n      if (options.all) {\n        await authHub.logout();\n        clack.outro(\"Logged out from all providers\");\n        return;\n      }\n\n      const providers: AuthProviderName[] = [];\n      if (options.claude) providers.push(\"claude\");\n      if (options.codex) providers.push(\"codex\");\n      if (options.gemini) providers.push(\"gemini\");\n\n      for (const provider of providers) {\n        await authHub.logout(provider);\n        logger.info(`Logged out from ${provider}`);\n      }\n    });\n\n  return auth;\n}\n\nasync function showAuthStatus(authHub: ReturnType<typeof getAuthHub>): Promise<void> {\n  const statuses = await authHub.status();\n\n  console.log(\"\\nAuthentication Status:\\n\");\n  console.log(\"+-----------+----------------+-----------+---------------------+\");\n  console.log(\"| Provider  | Status         | Type      | Expires             |\");\n  console.log(\"+-----------+----------------+-----------+---------------------+\");\n\n  for (const status of statuses) {\n    const icon = status.authenticated ? \"[OK]\" : \"[--]\";\n    const statusText = status.authenticated ? \"Authenticated\" : \"Not logged in\";\n    const typeText = status.type || \"-\";\n    const expiresText = status.expiresAt\n      ? status.expiresAt === Number.MAX_SAFE_INTEGER\n        ? \"Never\"\n        : new Date(status.expiresAt).toLocaleString()\n      : \"-\";\n\n    console.log(\n      `| ${status.provider.padEnd(9)} | ${icon} ${statusText.padEnd(10)} | ${typeText.padEnd(9)} | ${expiresText.padEnd(19)} |`\n    );\n  }\n\n  console.log(\"+-----------+----------------+-----------+---------------------+\");\n}\n", "/**\n * Claude (Anthropic) Auth Provider\n */\nimport * as clack from \"@clack/prompts\";\nimport { getTokenStore } from \"../../server/store/token-store\";\nimport type {\n  AuthProvider,\n  TokenData,\n  AuthResult,\n  LoginOptions,\n} from \"./types\";\nimport logger from \"../../shared/logger\";\n\nexport class ClaudeAuthProvider implements AuthProvider {\n  readonly name = \"claude\" as const;\n  readonly displayName = \"Claude (Anthropic)\";\n\n  private tokenStore = getTokenStore();\n\n  async login(options?: LoginOptions): Promise<AuthResult> {\n    try {\n      // Priority: options.apiKey > env > interactive prompt\n      let apiKey = options?.apiKey || process.env.ANTHROPIC_API_KEY;\n\n      if (!apiKey && options?.interactive !== false) {\n        clack.note(\n          \"Get your API key from:\\n\" +\n          \"https://console.anthropic.com/settings/keys\"\n        );\n\n        const input = await clack.password({\n          message: \"Enter your Anthropic API key:\",\n          validate: (value) => {\n            if (!value) return \"API key is required\";\n            if (!value.startsWith(\"sk-ant-\")) {\n              return \"Invalid API key format (should start with sk-ant-)\";\n            }\n          },\n        });\n\n        if (clack.isCancel(input)) {\n          return { success: false, error: \"Login cancelled\" };\n        }\n\n        apiKey = input as string;\n      }\n\n      if (!apiKey) {\n        return { success: false, error: \"API key is required\" };\n      }\n\n      // Validate API key\n      const isValid = await this.validateApiKey(apiKey);\n      if (!isValid) {\n        return { success: false, error: \"Invalid API key\" };\n      }\n\n      // Store token\n      const tokenData: TokenData = {\n        accessToken: apiKey,\n        provider: this.name,\n        type: \"api_key\",\n        expiresAt: Number.MAX_SAFE_INTEGER, // API keys don't expire\n      };\n\n      await this.tokenStore.store(this.name, tokenData);\n\n      return { success: true, provider: this.name };\n    } catch (error) {\n      logger.error(\"Claude login failed\", error as Error);\n      return { success: false, error: (error as Error).message };\n    }\n  }\n\n  async logout(accountId?: string): Promise<void> {\n    await this.tokenStore.delete(this.name, accountId);\n  }\n\n  async getToken(accountId?: string): Promise<string | null> {\n    const tokens = await this.tokenStore.retrieve(this.name, accountId);\n    return tokens?.accessToken ?? null;\n  }\n\n  async isAuthenticated(accountId?: string): Promise<boolean> {\n    return this.tokenStore.isValid(this.name, accountId);\n  }\n\n  private async validateApiKey(apiKey: string): Promise<boolean> {\n    try {\n      const response = await fetch(\"https://api.anthropic.com/v1/messages\", {\n        method: \"POST\",\n        headers: {\n          \"x-api-key\": apiKey,\n          \"anthropic-version\": \"2023-06-01\",\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          model: \"claude-3-haiku-20240307\",\n          max_tokens: 1,\n          messages: [{ role: \"user\", content: \"test\" }],\n        }),\n      });\n\n      // 200 or 400 (bad request) means key is valid\n      // 401 means invalid key\n      return response.status !== 401;\n    } catch (error) {\n      logger.error(\"API key validation failed\", error as Error);\n      return false;\n    }\n  }\n}\n", "/**\n * Token Store\n * Secure storage for API keys and OAuth tokens\n */\nimport { promises as fs } from \"fs\";\nimport { existsSync, mkdirSync } from \"fs\";\nimport * as crypto from \"crypto\";\nimport path from \"path\";\nimport type { TokenData, AuthProviderName } from \"../../services/auth/types\";\nimport logger from \"../../shared/logger\";\n\ninterface EncryptedData {\n  encryptedData: string;\n  iv: string;\n  authTag: string;\n}\n\nexport class TokenStore {\n  private readonly ALGORITHM = \"aes-256-gcm\";\n  private readonly KEY_LENGTH = 32;\n  private readonly IV_LENGTH = 16;\n  private encryptionKey: Buffer | null = null;\n\n  private readonly configDir: string;\n  private readonly keyFile: string;\n\n  constructor() {\n    const home = process.env.HOME || process.env.USERPROFILE || \".\";\n    this.configDir = path.join(home, \".config\", \"supercoin\");\n    this.keyFile = path.join(this.configDir, \".key\");\n\n    // Ensure config directory exists\n    if (!existsSync(this.configDir)) {\n      mkdirSync(this.configDir, { recursive: true, mode: 0o700 });\n    }\n  }\n\n  /**\n   * Get or create encryption key\n   */\n  private async getEncryptionKey(): Promise<Buffer> {\n    if (this.encryptionKey) {\n      return this.encryptionKey;\n    }\n\n    // Try to read existing key\n    if (existsSync(this.keyFile)) {\n      try {\n        const keyHex = await fs.readFile(this.keyFile, \"utf-8\");\n        this.encryptionKey = Buffer.from(keyHex.trim(), \"hex\");\n        return this.encryptionKey;\n      } catch {\n        // Key file corrupted, generate new\n      }\n    }\n\n    // Generate new key\n    this.encryptionKey = crypto.randomBytes(this.KEY_LENGTH);\n    await fs.writeFile(this.keyFile, this.encryptionKey.toString(\"hex\"), {\n      mode: 0o600,\n    });\n\n    return this.encryptionKey;\n  }\n\n  /**\n   * Encrypt data\n   */\n  private async encrypt(data: string): Promise<EncryptedData> {\n    const key = await this.getEncryptionKey();\n    const iv = crypto.randomBytes(this.IV_LENGTH);\n    const cipher = crypto.createCipheriv(this.ALGORITHM, key, iv);\n\n    let encrypted = cipher.update(data, \"utf8\", \"base64\");\n    encrypted += cipher.final(\"base64\");\n    const authTag = cipher.getAuthTag();\n\n    return {\n      encryptedData: encrypted,\n      iv: iv.toString(\"base64\"),\n      authTag: authTag.toString(\"base64\"),\n    };\n  }\n\n  /**\n   * Decrypt data\n   */\n  private async decrypt(encrypted: EncryptedData): Promise<string> {\n    const key = await this.getEncryptionKey();\n    const iv = Buffer.from(encrypted.iv, \"base64\");\n    const authTag = Buffer.from(encrypted.authTag, \"base64\");\n    const decipher = crypto.createDecipheriv(this.ALGORITHM, key, iv);\n    decipher.setAuthTag(authTag);\n\n    let decrypted = decipher.update(encrypted.encryptedData, \"base64\", \"utf8\");\n    decrypted += decipher.final(\"utf8\");\n    return decrypted;\n  }\n\n  /**\n   * Get token file path\n   */\n  private getTokenFilePath(provider: AuthProviderName, accountId?: string): string {\n    const fileName = accountId ? `${provider}_${accountId}.token` : `${provider}.token`;\n    return path.join(this.configDir, fileName);\n  }\n\n  /**\n   * Get all token files for a provider\n   */\n  private async getAllTokenFiles(provider: AuthProviderName): Promise<string[]> {\n    const files: string[] = [];\n    const { promises: fsp } = await import(\"fs\");\n    \n    try {\n      const dirFiles = await fsp.readdir(this.configDir);\n      for (const file of dirFiles) {\n        if (file.startsWith(`${provider}_`) && file.endsWith(\".token\")) {\n          files.push(path.join(this.configDir, file));\n        } else if (file === `${provider}.token`) {\n          files.push(path.join(this.configDir, file));\n        }\n      }\n    } catch {\n      // Directory might not exist yet\n    }\n    \n    return files;\n  }\n\n  /**\n   * Store token\n   */\n  async store(provider: AuthProviderName, tokens: TokenData): Promise<void> {\n    const filePath = this.getTokenFilePath(provider, tokens.accountId);\n    const encrypted = await this.encrypt(JSON.stringify(tokens));\n\n    await fs.writeFile(filePath, JSON.stringify(encrypted), {\n      mode: 0o600,\n    });\n\n    logger.debug(`Token stored for ${provider}${tokens.accountId ? ` (${tokens.accountId})` : \"\"}`);\n  }\n\n  /**\n   * Retrieve token\n   */\n  async retrieve(provider: AuthProviderName, accountId?: string): Promise<TokenData | null> {\n    const filePath = this.getTokenFilePath(provider, accountId);\n\n    try {\n      if (!existsSync(filePath)) {\n        return null;\n      }\n\n      const content = await fs.readFile(filePath, \"utf-8\");\n      const encrypted: EncryptedData = JSON.parse(content);\n      const decrypted = await this.decrypt(encrypted);\n\n      return JSON.parse(decrypted) as TokenData;\n    } catch (error) {\n      logger.error(`Failed to retrieve token for ${provider}${accountId ? ` (${accountId})` : \"\"}`, error as Error);\n      return null;\n    }\n  }\n\n  /**\n   * Retrieve all tokens for a provider\n   */\n  async retrieveAll(provider: AuthProviderName): Promise<TokenData[]> {\n    const files = await this.getAllTokenFiles(provider);\n    const tokens: TokenData[] = [];\n\n    for (const filePath of files) {\n      try {\n        const content = await fs.readFile(filePath, \"utf-8\");\n        const encrypted: EncryptedData = JSON.parse(content);\n        const decrypted = await this.decrypt(encrypted);\n        tokens.push(JSON.parse(decrypted) as TokenData);\n      } catch (error) {\n        logger.error(`Failed to retrieve token from ${filePath}`, error as Error);\n      }\n    }\n\n    return tokens;\n  }\n\n  /**\n   * Delete token\n   */\n  async delete(provider: AuthProviderName, accountId?: string): Promise<void> {\n    if (accountId === \"*\") {\n      const files = await this.getAllTokenFiles(provider);\n      for (const filePath of files) {\n        try {\n          await fs.unlink(filePath);\n        } catch (error) {\n          logger.error(`Failed to delete token file ${filePath}`, error as Error);\n        }\n      }\n      logger.debug(`All tokens deleted for ${provider}`);\n      return;\n    }\n\n    const filePath = this.getTokenFilePath(provider, accountId);\n\n    try {\n      if (existsSync(filePath)) {\n        await fs.unlink(filePath);\n        logger.debug(`Token deleted for ${provider}${accountId ? ` (${accountId})` : \"\"}`);\n      }\n    } catch (error) {\n      logger.error(`Failed to delete token for ${provider}${accountId ? ` (${accountId})` : \"\"}`, error as Error);\n    }\n  }\n\n  /**\n   * Check if token is valid (not expired)\n   */\n  async isValid(provider: AuthProviderName, accountId?: string): Promise<boolean> {\n    const tokens = await this.retrieve(provider, accountId);\n    if (!tokens) return false;\n\n    if (tokens.type === \"api_key\") return true;\n\n    const bufferMs = 5 * 60 * 1000;\n    return tokens.expiresAt > Date.now() + bufferMs;\n  }\n\n  /**\n   * Check if token needs refresh\n   */\n  async needsRefresh(provider: AuthProviderName, accountId?: string): Promise<boolean> {\n    const tokens = await this.retrieve(provider, accountId);\n    if (!tokens) return false;\n\n    if (tokens.type === \"api_key\") return false;\n\n    const refreshWindowMs = 15 * 60 * 1000;\n    return tokens.expiresAt < Date.now() + refreshWindowMs;\n  }\n}\n\n// Singleton instance\nlet tokenStoreInstance: TokenStore | null = null;\n\nexport function getTokenStore(): TokenStore {\n  if (!tokenStoreInstance) {\n    tokenStoreInstance = new TokenStore();\n  }\n  return tokenStoreInstance;\n}\n", "/**\n * Logger Utility\n * Simple logging with debug support\n */\n\nconst DEBUG = process.env.SUPERCOIN_DEBUG === \"1\" || process.env.DEBUG === \"supercoin\";\n\nexport const logger = {\n  debug: (message: string, data?: unknown): void => {\n    if (DEBUG) {\n      console.debug(`[supercoin:debug] ${message}`, data ?? \"\");\n    }\n  },\n\n  info: (message: string): void => {\n    console.log(`[supercoin] ${message}`);\n  },\n\n  warn: (message: string): void => {\n    console.warn(`[supercoin:warn] ${message}`);\n  },\n\n  error: (message: string, error?: Error): void => {\n    console.error(`[supercoin:error] ${message}`);\n    if (error && DEBUG) {\n      console.error(error.stack);\n    }\n  },\n\n  success: (message: string): void => {\n    console.log(`[supercoin] ${message}`);\n  },\n};\n\nexport default logger;\n", "/**\n * Codex (OpenAI) Auth Provider\n */\nimport * as clack from \"@clack/prompts\";\nimport { getTokenStore } from \"../../server/store/token-store\";\nimport type {\n  AuthProvider,\n  TokenData,\n  AuthResult,\n  LoginOptions,\n} from \"./types\";\nimport logger from \"../../shared/logger\";\n\nexport class CodexAuthProvider implements AuthProvider {\n  readonly name = \"codex\" as const;\n  readonly displayName = \"Codex (OpenAI)\";\n\n  private tokenStore = getTokenStore();\n\n  async login(options?: LoginOptions): Promise<AuthResult> {\n    try {\n      // Priority: options.apiKey > env > interactive prompt\n      let apiKey = options?.apiKey || process.env.OPENAI_API_KEY;\n\n      if (!apiKey && options?.interactive !== false) {\n        clack.note(\n          \"Get your API key from:\\n\" +\n          \"https://platform.openai.com/api-keys\"\n        );\n\n        const input = await clack.password({\n          message: \"Enter your OpenAI API key:\",\n          validate: (value) => {\n            if (!value) return \"API key is required\";\n            if (!value.startsWith(\"sk-\")) {\n              return \"Invalid API key format (should start with sk-)\";\n            }\n          },\n        });\n\n        if (clack.isCancel(input)) {\n          return { success: false, error: \"Login cancelled\" };\n        }\n\n        apiKey = input as string;\n      }\n\n      if (!apiKey) {\n        return { success: false, error: \"API key is required\" };\n      }\n\n      // Validate API key\n      const isValid = await this.validateApiKey(apiKey);\n      if (!isValid) {\n        return { success: false, error: \"Invalid API key\" };\n      }\n\n      // Store token\n      const tokenData: TokenData = {\n        accessToken: apiKey,\n        provider: this.name,\n        type: \"api_key\",\n        expiresAt: Number.MAX_SAFE_INTEGER,\n      };\n\n      await this.tokenStore.store(this.name, tokenData);\n\n      return { success: true, provider: this.name };\n    } catch (error) {\n      logger.error(\"Codex login failed\", error as Error);\n      return { success: false, error: (error as Error).message };\n    }\n  }\n\n  async logout(accountId?: string): Promise<void> {\n    await this.tokenStore.delete(this.name, accountId);\n  }\n\n  async getToken(accountId?: string): Promise<string | null> {\n    const tokens = await this.tokenStore.retrieve(this.name, accountId);\n    return tokens?.accessToken ?? null;\n  }\n\n  async isAuthenticated(accountId?: string): Promise<boolean> {\n    return this.tokenStore.isValid(this.name, accountId);\n  }\n\n  private async validateApiKey(apiKey: string): Promise<boolean> {\n    try {\n      const response = await fetch(\"https://api.openai.com/v1/models\", {\n        headers: {\n          Authorization: `Bearer ${apiKey}`,\n        },\n      });\n\n      return response.status === 200;\n    } catch (error) {\n      logger.error(\"API key validation failed\", error as Error);\n      return false;\n    }\n  }\n}\n", "/**\n * Gemini (Google) Auth Provider\n * Supports both API Key and OAuth with PKCE (via Antigravity)\n */\nimport * as clack from \"@clack/prompts\";\nimport { exec } from \"child_process\";\nimport { getTokenStore } from \"../../server/store/token-store\";\nimport { getOAuthStateStore } from \"../../server/store/oauth-state-store\";\nimport { startServer, isServerRunning } from \"../../server/index\";\nimport { waitForCallback } from \"../../server/routes/auth-callback\";\nimport type {\n  AuthProvider,\n  TokenData,\n  AuthResult,\n  LoginOptions,\n  OAuthState,\n} from \"./types\";\nimport logger from \"../../shared/logger\";\n\nconst ANTIGRAVITY_CLIENT_ID = \"1071006060591-tmhssin2h21lcre235vtolojh4g403ep.apps.googleusercontent.com\";\nconst ANTIGRAVITY_CLIENT_SECRET = \"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\";\nconst ANTIGRAVITY_SCOPES = [\n  \"https://www.googleapis.com/auth/cloud-platform\",\n  \"https://www.googleapis.com/auth/userinfo.email\",\n  \"https://www.googleapis.com/auth/userinfo.profile\",\n  \"https://www.googleapis.com/auth/cclog\",\n  \"https://www.googleapis.com/auth/experimentsandconfigs\",\n  \"https://www.googleapis.com/auth/generative-language.retriever\",\n];\nconst GOOGLE_AUTH_URL = \"https://accounts.google.com/o/oauth2/v2/auth\";\nconst GOOGLE_TOKEN_URL = \"https://oauth2.googleapis.com/token\";\nconst DEFAULT_SERVER_PORT = 3100;\n\nexport class GeminiAuthProvider implements AuthProvider {\n  readonly name = \"gemini\" as const;\n  readonly displayName = \"Gemini (Google)\";\n\n  private tokenStore = getTokenStore();\n  private oauthStateStore = getOAuthStateStore();\n\n  async login(options?: LoginOptions): Promise<AuthResult> {\n    try {\n      let apiKey = options?.apiKey || process.env.GOOGLE_API_KEY;\n\n      if (apiKey) {\n        return await this.loginWithApiKey(apiKey, options?.accountId);\n      }\n\n      if (options?.interactive !== false) {\n        const authMethod = await clack.select({\n          message: \"Select Gemini authentication method:\",\n          options: [\n            { value: \"oauth\", label: \"OAuth with Antigravity (Recommended)\", hint: \"Browser login\" },\n            { value: \"apikey\", label: \"API Key\", hint: \"Direct key input\" },\n          ],\n        });\n\n        if (clack.isCancel(authMethod)) {\n          return { success: false, error: \"Login cancelled\" };\n        }\n\n        if (authMethod === \"apikey\") {\n          const input = await clack.password({\n            message: \"Enter your Google AI API key:\",\n            validate: (value) => {\n              if (!value) return \"API key is required\";\n            },\n          });\n\n          if (clack.isCancel(input)) {\n            return { success: false, error: \"Login cancelled\" };\n          }\n          return await this.loginWithApiKey(input as string, options?.accountId);\n        } else {\n          return await this.loginWithOAuth(options?.accountId);\n        }\n      }\n\n      return { success: false, error: \"Authentication required\" };\n    } catch (error) {\n      logger.error(\"Gemini login failed\", error as Error);\n      return { success: false, error: (error as Error).message };\n    }\n  }\n\n  private async loginWithApiKey(apiKey: string, accountId?: string): Promise<AuthResult> {\n    const isValid = await this.validateApiKey(apiKey);\n    if (!isValid) {\n      return { success: false, error: \"Invalid API key\" };\n    }\n\n    const tokenData: TokenData = {\n      accessToken: apiKey,\n      provider: this.name,\n      type: \"api_key\",\n      expiresAt: Number.MAX_SAFE_INTEGER,\n      accountId: accountId || \"default\",\n    };\n\n    await this.tokenStore.store(this.name, tokenData);\n    return { success: true, provider: this.name, accountId: tokenData.accountId };\n  }\n\n  private async loginWithOAuth(accountId?: string): Promise<AuthResult> {\n    try {\n      if (!isServerRunning()) {\n        await startServer({ port: DEFAULT_SERVER_PORT, host: \"127.0.0.1\" });\n      }\n\n      const redirectUri = `http://localhost:${DEFAULT_SERVER_PORT}/callback/${this.name}`;\n      \n      const { verifier, challenge } = this.oauthStateStore.generatePKCEPair();\n      const state = this.oauthStateStore.generateState();\n\n      const oauthState: OAuthState = {\n        provider: this.name,\n        state,\n        codeVerifier: verifier,\n        createdAt: Date.now(),\n        accountId: accountId || `account_${Date.now()}`,\n      };\n\n      await this.oauthStateStore.store(oauthState);\n\n      const params = new URLSearchParams({\n        client_id: ANTIGRAVITY_CLIENT_ID,\n        response_type: \"code\",\n        redirect_uri: redirectUri,\n        scope: ANTIGRAVITY_SCOPES.join(\" \"),\n        code_challenge: challenge,\n        code_challenge_method: \"S256\",\n        state,\n        access_type: \"offline\",\n        prompt: \"consent\",\n      });\n\n      const authUrl = `${GOOGLE_AUTH_URL}?${params}`;\n\n      clack.note(`Opening browser for authentication...\\nIf browser doesn't open, visit:\\n${authUrl}`);\n      this.openBrowser(authUrl);\n\n      const { code, state: returnedState } = await waitForCallback(this.name, 120000);\n\n      const storedState = await this.oauthStateStore.retrieve(returnedState);\n      if (!storedState || storedState.state !== returnedState) {\n        throw new Error(\"Invalid state parameter (CSRF protection)\");\n      }\n\n      await this.exchangeCode(code, storedState.codeVerifier!, redirectUri, storedState.accountId!);\n      await this.oauthStateStore.delete(returnedState);\n\n      return { success: true, provider: this.name, accountId: storedState.accountId };\n    } catch (error) {\n      logger.error(\"OAuth flow failed\", error as Error);\n      return { success: false, error: (error as Error).message };\n    }\n  }\n\n  async logout(accountId?: string): Promise<void> {\n    const tokens = await this.tokenStore.retrieve(this.name, accountId);\n    if (tokens?.type === \"oauth\" && tokens.accessToken) {\n      try {\n        await fetch(`https://oauth2.googleapis.com/revoke?token=${tokens.accessToken}`, {\n          method: \"POST\",\n        });\n      } catch {\n        // Ignore revocation errors\n      }\n    }\n    await this.tokenStore.delete(this.name, accountId);\n  }\n\n  async refresh(accountId?: string): Promise<TokenData> {\n    const currentTokens = await this.tokenStore.retrieve(this.name, accountId);\n    if (!currentTokens?.refreshToken) {\n      throw new Error(\"No refresh token available\");\n    }\n\n    const response = await fetch(GOOGLE_TOKEN_URL, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n      body: new URLSearchParams({\n        client_id: ANTIGRAVITY_CLIENT_ID,\n        client_secret: ANTIGRAVITY_CLIENT_SECRET,\n        refresh_token: currentTokens.refreshToken,\n        grant_type: \"refresh_token\",\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Token refresh failed\");\n    }\n\n    const data = await response.json() as { access_token: string; expires_in: number; refresh_token?: string };\n    \n    const newTokenData: TokenData = {\n      ...currentTokens,\n      accessToken: data.access_token,\n      refreshToken: data.refresh_token || currentTokens.refreshToken,\n      expiresAt: Date.now() + data.expires_in * 1000,\n    };\n\n    await this.tokenStore.store(this.name, newTokenData);\n    return newTokenData;\n  }\n\n  async getToken(accountId?: string): Promise<string | null> {\n    const tokens = await this.tokenStore.retrieve(this.name, accountId);\n    if (!tokens) return null;\n\n    if (tokens.type === \"oauth\") {\n      const needsRefresh = await this.tokenStore.needsRefresh(this.name, accountId);\n      if (needsRefresh && tokens.refreshToken) {\n        try {\n          const newTokens = await this.refresh(accountId);\n          return newTokens.accessToken;\n        } catch {\n          return null;\n        }\n      }\n    }\n    return tokens.accessToken;\n  }\n\n  async isAuthenticated(accountId?: string): Promise<boolean> {\n    return this.tokenStore.isValid(this.name, accountId);\n  }\n\n  private async validateApiKey(apiKey: string): Promise<boolean> {\n    try {\n      const response = await fetch(\n        `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`\n      );\n      return response.ok;\n    } catch {\n      return false;\n    }\n  }\n\n  private async exchangeCode(code: string, verifier: string, redirectUri: string, accountId: string): Promise<TokenData> {\n    const response = await fetch(GOOGLE_TOKEN_URL, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n      body: new URLSearchParams({\n        client_id: ANTIGRAVITY_CLIENT_ID,\n        client_secret: ANTIGRAVITY_CLIENT_SECRET,\n        code,\n        code_verifier: verifier,\n        grant_type: \"authorization_code\",\n        redirect_uri: redirectUri,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Token exchange failed: ${await response.text()}`);\n    }\n\n    const data = await response.json() as { \n      access_token: string; \n      refresh_token?: string; \n      expires_in: number \n    };\n\n    const tokenData: TokenData = {\n      accessToken: data.access_token,\n      refreshToken: data.refresh_token,\n      provider: this.name,\n      type: \"oauth\",\n      expiresAt: Date.now() + data.expires_in * 1000,\n      scopes: ANTIGRAVITY_SCOPES,\n      accountId,\n    };\n\n    await this.tokenStore.store(this.name, tokenData);\n    return tokenData;\n  }\n\n  private openBrowser(url: string) {\n    const start = process.platform === \"darwin\" ? \"open\" : process.platform === \"win32\" ? \"start\" : \"xdg-open\";\n    exec(`${start} \"${url}\"`);\n  }\n}\n", "import { promises as fs } from \"fs\";\nimport { existsSync } from \"fs\";\nimport * as crypto from \"crypto\";\nimport path from \"path\";\nimport type { OAuthState, AuthProviderName } from \"../../services/auth/types\";\nimport logger from \"../../shared/logger\";\n\nconst STATE_EXPIRY_MS = 10 * 60 * 1000;\n\nexport class OAuthStateStore {\n  private states: Map<string, OAuthState> = new Map();\n  private readonly configDir: string;\n  private readonly stateFile: string;\n\n  constructor() {\n    const home = process.env.HOME || process.env.USERPROFILE || \".\";\n    this.configDir = path.join(home, \".config\", \"supercoin\");\n    this.stateFile = path.join(this.configDir, \".oauth-states\");\n    this.loadStates();\n    this.startCleanupTimer();\n  }\n\n  private async loadStates(): Promise<void> {\n    try {\n      if (existsSync(this.stateFile)) {\n        const content = await fs.readFile(this.stateFile, \"utf-8\");\n        const data = JSON.parse(content);\n        this.states = new Map(Object.entries(data));\n        this.cleanupExpired();\n      }\n    } catch (error) {\n      logger.error(\"Failed to load OAuth states\", error as Error);\n      this.states.clear();\n    }\n  }\n\n  private async saveStates(): Promise<void> {\n    try {\n      const data = Object.fromEntries(this.states);\n      await fs.writeFile(this.stateFile, JSON.stringify(data), { mode: 0o600 });\n    } catch (error) {\n      logger.error(\"Failed to save OAuth states\", error as Error);\n    }\n  }\n\n  async store(state: OAuthState): Promise<void> {\n    this.states.set(state.state, state);\n    await this.saveStates();\n  }\n\n  async retrieve(stateValue: string): Promise<OAuthState | null> {\n    const state = this.states.get(stateValue);\n    if (!state) return null;\n\n    if (Date.now() - state.createdAt > STATE_EXPIRY_MS) {\n      this.states.delete(stateValue);\n      await this.saveStates();\n      return null;\n    }\n\n    return state;\n  }\n\n  async delete(stateValue: string): Promise<void> {\n    this.states.delete(stateValue);\n    await this.saveStates();\n  }\n\n  async deleteByProvider(provider: AuthProviderName): Promise<void> {\n    for (const [key, value] of this.states.entries()) {\n      if (value.provider === provider) {\n        this.states.delete(key);\n      }\n    }\n    await this.saveStates();\n  }\n\n  private cleanupExpired(): void {\n    const now = Date.now();\n    for (const [key, value] of this.states.entries()) {\n      if (now - value.createdAt > STATE_EXPIRY_MS) {\n        this.states.delete(key);\n      }\n    }\n  }\n\n  private startCleanupTimer(): void {\n    setInterval(() => {\n      this.cleanupExpired();\n      this.saveStates();\n    }, 60000);\n  }\n\n  generatePKCEPair(): { verifier: string; challenge: string } {\n    const verifier = crypto.randomBytes(64).toString(\"base64url\");\n    const challenge = crypto.createHash(\"sha256\").update(verifier).digest(\"base64url\");\n    return { verifier, challenge };\n  }\n\n  generateState(): string {\n    return crypto.randomBytes(32).toString(\"hex\");\n  }\n}\n\nlet oauthStateStoreInstance: OAuthStateStore | null = null;\n\nexport function getOAuthStateStore(): OAuthStateStore {\n  if (!oauthStateStoreInstance) {\n    oauthStateStoreInstance = new OAuthStateStore();\n  }\n  return oauthStateStoreInstance;\n}\n", "// src/server.ts\nimport { createServer as createServerHTTP } from \"http\";\n\n// src/listener.ts\nimport { Http2ServerRequest as Http2ServerRequest2 } from \"http2\";\n\n// src/request.ts\nimport { Http2ServerRequest } from \"http2\";\nimport { Readable } from \"stream\";\nvar RequestError = class extends Error {\n  constructor(message, options) {\n    super(message, options);\n    this.name = \"RequestError\";\n  }\n};\nvar toRequestError = (e) => {\n  if (e instanceof RequestError) {\n    return e;\n  }\n  return new RequestError(e.message, { cause: e });\n};\nvar GlobalRequest = global.Request;\nvar Request = class extends GlobalRequest {\n  constructor(input, options) {\n    if (typeof input === \"object\" && getRequestCache in input) {\n      input = input[getRequestCache]();\n    }\n    if (typeof options?.body?.getReader !== \"undefined\") {\n      ;\n      options.duplex ??= \"half\";\n    }\n    super(input, options);\n  }\n};\nvar newHeadersFromIncoming = (incoming) => {\n  const headerRecord = [];\n  const rawHeaders = incoming.rawHeaders;\n  for (let i = 0; i < rawHeaders.length; i += 2) {\n    const { [i]: key, [i + 1]: value } = rawHeaders;\n    if (key.charCodeAt(0) !== /*:*/\n    58) {\n      headerRecord.push([key, value]);\n    }\n  }\n  return new Headers(headerRecord);\n};\nvar wrapBodyStream = Symbol(\"wrapBodyStream\");\nvar newRequestFromIncoming = (method, url, headers, incoming, abortController) => {\n  const init = {\n    method,\n    headers,\n    signal: abortController.signal\n  };\n  if (method === \"TRACE\") {\n    init.method = \"GET\";\n    const req = new Request(url, init);\n    Object.defineProperty(req, \"method\", {\n      get() {\n        return \"TRACE\";\n      }\n    });\n    return req;\n  }\n  if (!(method === \"GET\" || method === \"HEAD\")) {\n    if (\"rawBody\" in incoming && incoming.rawBody instanceof Buffer) {\n      init.body = new ReadableStream({\n        start(controller) {\n          controller.enqueue(incoming.rawBody);\n          controller.close();\n        }\n      });\n    } else if (incoming[wrapBodyStream]) {\n      let reader;\n      init.body = new ReadableStream({\n        async pull(controller) {\n          try {\n            reader ||= Readable.toWeb(incoming).getReader();\n            const { done, value } = await reader.read();\n            if (done) {\n              controller.close();\n            } else {\n              controller.enqueue(value);\n            }\n          } catch (error) {\n            controller.error(error);\n          }\n        }\n      });\n    } else {\n      init.body = Readable.toWeb(incoming);\n    }\n  }\n  return new Request(url, init);\n};\nvar getRequestCache = Symbol(\"getRequestCache\");\nvar requestCache = Symbol(\"requestCache\");\nvar incomingKey = Symbol(\"incomingKey\");\nvar urlKey = Symbol(\"urlKey\");\nvar headersKey = Symbol(\"headersKey\");\nvar abortControllerKey = Symbol(\"abortControllerKey\");\nvar getAbortController = Symbol(\"getAbortController\");\nvar requestPrototype = {\n  get method() {\n    return this[incomingKey].method || \"GET\";\n  },\n  get url() {\n    return this[urlKey];\n  },\n  get headers() {\n    return this[headersKey] ||= newHeadersFromIncoming(this[incomingKey]);\n  },\n  [getAbortController]() {\n    this[getRequestCache]();\n    return this[abortControllerKey];\n  },\n  [getRequestCache]() {\n    this[abortControllerKey] ||= new AbortController();\n    return this[requestCache] ||= newRequestFromIncoming(\n      this.method,\n      this[urlKey],\n      this.headers,\n      this[incomingKey],\n      this[abortControllerKey]\n    );\n  }\n};\n[\n  \"body\",\n  \"bodyUsed\",\n  \"cache\",\n  \"credentials\",\n  \"destination\",\n  \"integrity\",\n  \"mode\",\n  \"redirect\",\n  \"referrer\",\n  \"referrerPolicy\",\n  \"signal\",\n  \"keepalive\"\n].forEach((k) => {\n  Object.defineProperty(requestPrototype, k, {\n    get() {\n      return this[getRequestCache]()[k];\n    }\n  });\n});\n[\"arrayBuffer\", \"blob\", \"clone\", \"formData\", \"json\", \"text\"].forEach((k) => {\n  Object.defineProperty(requestPrototype, k, {\n    value: function() {\n      return this[getRequestCache]()[k]();\n    }\n  });\n});\nObject.setPrototypeOf(requestPrototype, Request.prototype);\nvar newRequest = (incoming, defaultHostname) => {\n  const req = Object.create(requestPrototype);\n  req[incomingKey] = incoming;\n  const incomingUrl = incoming.url || \"\";\n  if (incomingUrl[0] !== \"/\" && // short-circuit for performance. most requests are relative URL.\n  (incomingUrl.startsWith(\"http://\") || incomingUrl.startsWith(\"https://\"))) {\n    if (incoming instanceof Http2ServerRequest) {\n      throw new RequestError(\"Absolute URL for :path is not allowed in HTTP/2\");\n    }\n    try {\n      const url2 = new URL(incomingUrl);\n      req[urlKey] = url2.href;\n    } catch (e) {\n      throw new RequestError(\"Invalid absolute URL\", { cause: e });\n    }\n    return req;\n  }\n  const host = (incoming instanceof Http2ServerRequest ? incoming.authority : incoming.headers.host) || defaultHostname;\n  if (!host) {\n    throw new RequestError(\"Missing host header\");\n  }\n  let scheme;\n  if (incoming instanceof Http2ServerRequest) {\n    scheme = incoming.scheme;\n    if (!(scheme === \"http\" || scheme === \"https\")) {\n      throw new RequestError(\"Unsupported scheme\");\n    }\n  } else {\n    scheme = incoming.socket && incoming.socket.encrypted ? \"https\" : \"http\";\n  }\n  const url = new URL(`${scheme}://${host}${incomingUrl}`);\n  if (url.hostname.length !== host.length && url.hostname !== host.replace(/:\\d+$/, \"\")) {\n    throw new RequestError(\"Invalid host header\");\n  }\n  req[urlKey] = url.href;\n  return req;\n};\n\n// src/response.ts\nvar responseCache = Symbol(\"responseCache\");\nvar getResponseCache = Symbol(\"getResponseCache\");\nvar cacheKey = Symbol(\"cache\");\nvar GlobalResponse = global.Response;\nvar Response2 = class _Response {\n  #body;\n  #init;\n  [getResponseCache]() {\n    delete this[cacheKey];\n    return this[responseCache] ||= new GlobalResponse(this.#body, this.#init);\n  }\n  constructor(body, init) {\n    let headers;\n    this.#body = body;\n    if (init instanceof _Response) {\n      const cachedGlobalResponse = init[responseCache];\n      if (cachedGlobalResponse) {\n        this.#init = cachedGlobalResponse;\n        this[getResponseCache]();\n        return;\n      } else {\n        this.#init = init.#init;\n        headers = new Headers(init.#init.headers);\n      }\n    } else {\n      this.#init = init;\n    }\n    if (typeof body === \"string\" || typeof body?.getReader !== \"undefined\" || body instanceof Blob || body instanceof Uint8Array) {\n      headers ||= init?.headers || { \"content-type\": \"text/plain; charset=UTF-8\" };\n      this[cacheKey] = [init?.status || 200, body, headers];\n    }\n  }\n  get headers() {\n    const cache = this[cacheKey];\n    if (cache) {\n      if (!(cache[2] instanceof Headers)) {\n        cache[2] = new Headers(cache[2]);\n      }\n      return cache[2];\n    }\n    return this[getResponseCache]().headers;\n  }\n  get status() {\n    return this[cacheKey]?.[0] ?? this[getResponseCache]().status;\n  }\n  get ok() {\n    const status = this.status;\n    return status >= 200 && status < 300;\n  }\n};\n[\"body\", \"bodyUsed\", \"redirected\", \"statusText\", \"trailers\", \"type\", \"url\"].forEach((k) => {\n  Object.defineProperty(Response2.prototype, k, {\n    get() {\n      return this[getResponseCache]()[k];\n    }\n  });\n});\n[\"arrayBuffer\", \"blob\", \"clone\", \"formData\", \"json\", \"text\"].forEach((k) => {\n  Object.defineProperty(Response2.prototype, k, {\n    value: function() {\n      return this[getResponseCache]()[k]();\n    }\n  });\n});\nObject.setPrototypeOf(Response2, GlobalResponse);\nObject.setPrototypeOf(Response2.prototype, GlobalResponse.prototype);\n\n// src/utils.ts\nasync function readWithoutBlocking(readPromise) {\n  return Promise.race([readPromise, Promise.resolve().then(() => Promise.resolve(void 0))]);\n}\nfunction writeFromReadableStreamDefaultReader(reader, writable, currentReadPromise) {\n  const cancel = (error) => {\n    reader.cancel(error).catch(() => {\n    });\n  };\n  writable.on(\"close\", cancel);\n  writable.on(\"error\", cancel);\n  (currentReadPromise ?? reader.read()).then(flow, handleStreamError);\n  return reader.closed.finally(() => {\n    writable.off(\"close\", cancel);\n    writable.off(\"error\", cancel);\n  });\n  function handleStreamError(error) {\n    if (error) {\n      writable.destroy(error);\n    }\n  }\n  function onDrain() {\n    reader.read().then(flow, handleStreamError);\n  }\n  function flow({ done, value }) {\n    try {\n      if (done) {\n        writable.end();\n      } else if (!writable.write(value)) {\n        writable.once(\"drain\", onDrain);\n      } else {\n        return reader.read().then(flow, handleStreamError);\n      }\n    } catch (e) {\n      handleStreamError(e);\n    }\n  }\n}\nfunction writeFromReadableStream(stream, writable) {\n  if (stream.locked) {\n    throw new TypeError(\"ReadableStream is locked.\");\n  } else if (writable.destroyed) {\n    return;\n  }\n  return writeFromReadableStreamDefaultReader(stream.getReader(), writable);\n}\nvar buildOutgoingHttpHeaders = (headers) => {\n  const res = {};\n  if (!(headers instanceof Headers)) {\n    headers = new Headers(headers ?? void 0);\n  }\n  const cookies = [];\n  for (const [k, v] of headers) {\n    if (k === \"set-cookie\") {\n      cookies.push(v);\n    } else {\n      res[k] = v;\n    }\n  }\n  if (cookies.length > 0) {\n    res[\"set-cookie\"] = cookies;\n  }\n  res[\"content-type\"] ??= \"text/plain; charset=UTF-8\";\n  return res;\n};\n\n// src/utils/response/constants.ts\nvar X_ALREADY_SENT = \"x-hono-already-sent\";\n\n// src/globals.ts\nimport crypto from \"crypto\";\nvar webFetch = global.fetch;\nif (typeof global.crypto === \"undefined\") {\n  global.crypto = crypto;\n}\nglobal.fetch = (info, init) => {\n  init = {\n    // Disable compression handling so people can return the result of a fetch\n    // directly in the loader without messing with the Content-Encoding header.\n    compress: false,\n    ...init\n  };\n  return webFetch(info, init);\n};\n\n// src/listener.ts\nvar outgoingEnded = Symbol(\"outgoingEnded\");\nvar handleRequestError = () => new Response(null, {\n  status: 400\n});\nvar handleFetchError = (e) => new Response(null, {\n  status: e instanceof Error && (e.name === \"TimeoutError\" || e.constructor.name === \"TimeoutError\") ? 504 : 500\n});\nvar handleResponseError = (e, outgoing) => {\n  const err = e instanceof Error ? e : new Error(\"unknown error\", { cause: e });\n  if (err.code === \"ERR_STREAM_PREMATURE_CLOSE\") {\n    console.info(\"The user aborted a request.\");\n  } else {\n    console.error(e);\n    if (!outgoing.headersSent) {\n      outgoing.writeHead(500, { \"Content-Type\": \"text/plain\" });\n    }\n    outgoing.end(`Error: ${err.message}`);\n    outgoing.destroy(err);\n  }\n};\nvar flushHeaders = (outgoing) => {\n  if (\"flushHeaders\" in outgoing && outgoing.writable) {\n    outgoing.flushHeaders();\n  }\n};\nvar responseViaCache = async (res, outgoing) => {\n  let [status, body, header] = res[cacheKey];\n  if (header instanceof Headers) {\n    header = buildOutgoingHttpHeaders(header);\n  }\n  if (typeof body === \"string\") {\n    header[\"Content-Length\"] = Buffer.byteLength(body);\n  } else if (body instanceof Uint8Array) {\n    header[\"Content-Length\"] = body.byteLength;\n  } else if (body instanceof Blob) {\n    header[\"Content-Length\"] = body.size;\n  }\n  outgoing.writeHead(status, header);\n  if (typeof body === \"string\" || body instanceof Uint8Array) {\n    outgoing.end(body);\n  } else if (body instanceof Blob) {\n    outgoing.end(new Uint8Array(await body.arrayBuffer()));\n  } else {\n    flushHeaders(outgoing);\n    await writeFromReadableStream(body, outgoing)?.catch(\n      (e) => handleResponseError(e, outgoing)\n    );\n  }\n  ;\n  outgoing[outgoingEnded]?.();\n};\nvar isPromise = (res) => typeof res.then === \"function\";\nvar responseViaResponseObject = async (res, outgoing, options = {}) => {\n  if (isPromise(res)) {\n    if (options.errorHandler) {\n      try {\n        res = await res;\n      } catch (err) {\n        const errRes = await options.errorHandler(err);\n        if (!errRes) {\n          return;\n        }\n        res = errRes;\n      }\n    } else {\n      res = await res.catch(handleFetchError);\n    }\n  }\n  if (cacheKey in res) {\n    return responseViaCache(res, outgoing);\n  }\n  const resHeaderRecord = buildOutgoingHttpHeaders(res.headers);\n  if (res.body) {\n    const reader = res.body.getReader();\n    const values = [];\n    let done = false;\n    let currentReadPromise = void 0;\n    if (resHeaderRecord[\"transfer-encoding\"] !== \"chunked\") {\n      let maxReadCount = 2;\n      for (let i = 0; i < maxReadCount; i++) {\n        currentReadPromise ||= reader.read();\n        const chunk = await readWithoutBlocking(currentReadPromise).catch((e) => {\n          console.error(e);\n          done = true;\n        });\n        if (!chunk) {\n          if (i === 1) {\n            await new Promise((resolve) => setTimeout(resolve));\n            maxReadCount = 3;\n            continue;\n          }\n          break;\n        }\n        currentReadPromise = void 0;\n        if (chunk.value) {\n          values.push(chunk.value);\n        }\n        if (chunk.done) {\n          done = true;\n          break;\n        }\n      }\n      if (done && !(\"content-length\" in resHeaderRecord)) {\n        resHeaderRecord[\"content-length\"] = values.reduce((acc, value) => acc + value.length, 0);\n      }\n    }\n    outgoing.writeHead(res.status, resHeaderRecord);\n    values.forEach((value) => {\n      ;\n      outgoing.write(value);\n    });\n    if (done) {\n      outgoing.end();\n    } else {\n      if (values.length === 0) {\n        flushHeaders(outgoing);\n      }\n      await writeFromReadableStreamDefaultReader(reader, outgoing, currentReadPromise);\n    }\n  } else if (resHeaderRecord[X_ALREADY_SENT]) {\n  } else {\n    outgoing.writeHead(res.status, resHeaderRecord);\n    outgoing.end();\n  }\n  ;\n  outgoing[outgoingEnded]?.();\n};\nvar getRequestListener = (fetchCallback, options = {}) => {\n  const autoCleanupIncoming = options.autoCleanupIncoming ?? true;\n  if (options.overrideGlobalObjects !== false && global.Request !== Request) {\n    Object.defineProperty(global, \"Request\", {\n      value: Request\n    });\n    Object.defineProperty(global, \"Response\", {\n      value: Response2\n    });\n  }\n  return async (incoming, outgoing) => {\n    let res, req;\n    try {\n      req = newRequest(incoming, options.hostname);\n      let incomingEnded = !autoCleanupIncoming || incoming.method === \"GET\" || incoming.method === \"HEAD\";\n      if (!incomingEnded) {\n        ;\n        incoming[wrapBodyStream] = true;\n        incoming.on(\"end\", () => {\n          incomingEnded = true;\n        });\n        if (incoming instanceof Http2ServerRequest2) {\n          ;\n          outgoing[outgoingEnded] = () => {\n            if (!incomingEnded) {\n              setTimeout(() => {\n                if (!incomingEnded) {\n                  setTimeout(() => {\n                    incoming.destroy();\n                    outgoing.destroy();\n                  });\n                }\n              });\n            }\n          };\n        }\n      }\n      outgoing.on(\"close\", () => {\n        const abortController = req[abortControllerKey];\n        if (abortController) {\n          if (incoming.errored) {\n            req[abortControllerKey].abort(incoming.errored.toString());\n          } else if (!outgoing.writableFinished) {\n            req[abortControllerKey].abort(\"Client connection prematurely closed.\");\n          }\n        }\n        if (!incomingEnded) {\n          setTimeout(() => {\n            if (!incomingEnded) {\n              setTimeout(() => {\n                incoming.destroy();\n              });\n            }\n          });\n        }\n      });\n      res = fetchCallback(req, { incoming, outgoing });\n      if (cacheKey in res) {\n        return responseViaCache(res, outgoing);\n      }\n    } catch (e) {\n      if (!res) {\n        if (options.errorHandler) {\n          res = await options.errorHandler(req ? e : toRequestError(e));\n          if (!res) {\n            return;\n          }\n        } else if (!req) {\n          res = handleRequestError();\n        } else {\n          res = handleFetchError(e);\n        }\n      } else {\n        return handleResponseError(e, outgoing);\n      }\n    }\n    try {\n      return await responseViaResponseObject(res, outgoing, options);\n    } catch (e) {\n      return handleResponseError(e, outgoing);\n    }\n  };\n};\n\n// src/server.ts\nvar createAdaptorServer = (options) => {\n  const fetchCallback = options.fetch;\n  const requestListener = getRequestListener(fetchCallback, {\n    hostname: options.hostname,\n    overrideGlobalObjects: options.overrideGlobalObjects,\n    autoCleanupIncoming: options.autoCleanupIncoming\n  });\n  const createServer = options.createServer || createServerHTTP;\n  const server = createServer(options.serverOptions || {}, requestListener);\n  return server;\n};\nvar serve = (options, listeningListener) => {\n  const server = createAdaptorServer(options);\n  server.listen(options?.port ?? 3e3, options.hostname, () => {\n    const serverInfo = server.address();\n    listeningListener && listeningListener(serverInfo);\n  });\n  return server;\n};\nexport {\n  RequestError,\n  createAdaptorServer,\n  getRequestListener,\n  serve\n};\n", "import { serve } from \"@hono/node-server\";\nimport { Hono } from \"hono\";\nimport { cors } from \"hono/cors\";\nimport { logger as honoLogger } from \"hono/logger\";\nimport { createRoutes } from \"./routes\";\nimport type { ServerConfig, ServerStatus } from \"./types\";\n\nlet serverInstance: any = null;\nlet serverStartTime: number | null = null;\nlet serverInfo: { port: number; host: string } | null = null;\n\nexport function createServer(): Hono {\n  const app = new Hono();\n\n  app.use(\"*\", cors());\n  app.use(\"*\", honoLogger());\n\n  app.get(\"/\", (c) => {\n    return c.json({\n      name: \"supercoin\",\n      version: \"0.1.0\",\n      status: \"running\",\n    });\n  });\n\n  app.route(\"/\", createRoutes());\n\n  app.notFound((c) => {\n    return c.json({ error: \"Not Found\" }, 404);\n  });\n\n  app.onError((err, c) => {\n    console.error(`[supercoin:server] Error: ${err.message}`);\n    return c.json({ error: err.message }, 500);\n  });\n\n  return app;\n}\n\nexport async function startServer(config: ServerConfig): Promise<ServerStatus> {\n  if (serverInstance) {\n    return getServerStatus();\n  }\n\n  const app = createServer();\n\n  if (typeof Bun !== \"undefined\") {\n    serverInstance = Bun.serve({\n      port: config.port,\n      hostname: config.host,\n      fetch: app.fetch,\n    });\n    serverInfo = { port: serverInstance.port, host: serverInstance.hostname };\n  } else {\n    serverInstance = serve({\n      fetch: app.fetch,\n      port: config.port,\n      hostname: config.host,\n    });\n    serverInfo = { port: config.port, host: config.host };\n  }\n\n  serverStartTime = Date.now();\n\n  return {\n    running: true,\n    port: serverInfo.port,\n    host: serverInfo.host,\n    pid: process.pid,\n    uptime: 0,\n  };\n}\n\nexport async function stopServer(): Promise<void> {\n  if (serverInstance) {\n    if (typeof Bun !== \"undefined\") {\n      serverInstance.stop();\n    } else {\n      serverInstance.close();\n    }\n    serverInstance = null;\n    serverStartTime = null;\n    serverInfo = null;\n  }\n}\n\nexport function getServerStatus(): ServerStatus {\n  if (!serverInstance || !serverInfo) {\n    return { running: false };\n  }\n\n  return {\n    running: true,\n    port: serverInfo.port,\n    host: serverInfo.host,\n    pid: process.pid,\n    uptime: serverStartTime ? Math.floor((Date.now() - serverStartTime) / 1000) : 0,\n  };\n}\n\nexport function isServerRunning(): boolean {\n  return serverInstance !== null;\n}\n\nexport { createRoutes } from \"./routes\";\nexport * from \"./types\";\n", "import { Hono } from \"hono\";\nimport { createHealthRoutes } from \"./health\";\nimport { createAuthCallbackRoutes } from \"./auth-callback\";\n\nexport function createRoutes(): Hono {\n  const app = new Hono();\n\n  app.route(\"/health\", createHealthRoutes());\n  app.route(\"/callback\", createAuthCallbackRoutes());\n\n  return app;\n}\n\nexport { createHealthRoutes } from \"./health\";\nexport { createAuthCallbackRoutes, callbackEmitter, waitForCallback } from \"./auth-callback\";\n", "import { Hono } from \"hono\";\n\nexport function createHealthRoutes(): Hono {\n  const app = new Hono();\n\n  app.get(\"/\", (c) => {\n    return c.json({\n      status: \"ok\",\n      timestamp: new Date().toISOString(),\n      version: \"0.1.0\",\n    });\n  });\n\n  app.get(\"/ready\", (c) => {\n    return c.json({\n      status: \"ready\",\n      timestamp: new Date().toISOString(),\n    });\n  });\n\n  return app;\n}\n", "import { Hono } from \"hono\";\nimport { html } from \"hono/html\";\nimport { EventEmitter } from \"events\";\nimport type { OAuthCallbackData } from \"../../services/auth/types\";\n\nexport const callbackEmitter = new EventEmitter();\n\nexport function createAuthCallbackRoutes(): Hono {\n  const app = new Hono();\n\n  app.get(\"/:provider\", async (c) => {\n    const provider = c.req.param(\"provider\");\n    const code = c.req.query(\"code\");\n    const state = c.req.query(\"state\");\n    const error = c.req.query(\"error\");\n    const errorDescription = c.req.query(\"error_description\");\n\n    if (error) {\n      const callbackData: OAuthCallbackData = {\n        code: \"\",\n        state: state || \"\",\n        error,\n        errorDescription,\n      };\n\n      callbackEmitter.emit(`callback:${provider}`, {\n        success: false,\n        provider,\n        ...callbackData,\n      });\n\n      return c.html(html`\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>Authentication Failed</title>\n            <style>\n              body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                height: 100vh;\n                margin: 0;\n                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n                color: #fff;\n              }\n              .container {\n                text-align: center;\n                padding: 40px;\n                background: rgba(255,255,255,0.1);\n                border-radius: 12px;\n                backdrop-filter: blur(10px);\n              }\n              h1 { color: #ff6b6b; margin-bottom: 16px; }\n              p { color: #ddd; margin: 8px 0; }\n              .error { color: #ff6b6b; font-size: 14px; }\n            </style>\n          </head>\n          <body>\n            <div class=\"container\">\n              <h1>\u274C Authentication Failed</h1>\n              <p>Provider: <strong>${provider}</strong></p>\n              <p class=\"error\">${errorDescription || error}</p>\n              <p>You can close this window.</p>\n            </div>\n            <script>setTimeout(() => window.close(), 5000);</script>\n          </body>\n        </html>\n      `);\n    }\n\n    if (!code) {\n      return c.html(html`\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>Authentication Error</title>\n            <style>\n              body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                height: 100vh;\n                margin: 0;\n                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n                color: #fff;\n              }\n              .container {\n                text-align: center;\n                padding: 40px;\n                background: rgba(255,255,255,0.1);\n                border-radius: 12px;\n              }\n              h1 { color: #ff6b6b; }\n            </style>\n          </head>\n          <body>\n            <div class=\"container\">\n              <h1>\u274C Missing Authorization Code</h1>\n              <p>The authorization code was not received.</p>\n            </div>\n          </body>\n        </html>\n      `);\n    }\n\n    if (!state) {\n      return c.html(html`\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>Security Error</title>\n            <style>\n              body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                height: 100vh;\n                margin: 0;\n                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n                color: #fff;\n              }\n              .container {\n                text-align: center;\n                padding: 40px;\n                background: rgba(255,255,255,0.1);\n                border-radius: 12px;\n              }\n              h1 { color: #ff6b6b; }\n            </style>\n          </head>\n          <body>\n            <div class=\"container\">\n              <h1>\uD83D\uDEE1\uFE0F Security Error</h1>\n              <p>Missing state parameter (CSRF protection).</p>\n            </div>\n          </body>\n        </html>\n      `);\n    }\n\n    const callbackData: OAuthCallbackData = {\n      code,\n      state,\n    };\n\n    callbackEmitter.emit(`callback:${provider}`, {\n      success: true,\n      provider,\n      ...callbackData,\n    });\n\n    return c.html(html`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Authentication Successful</title>\n          <style>\n            body {\n              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n              height: 100vh;\n              margin: 0;\n              background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n              color: #fff;\n            }\n            .container {\n              text-align: center;\n              padding: 40px;\n              background: rgba(255,255,255,0.1);\n              border-radius: 12px;\n              backdrop-filter: blur(10px);\n            }\n            h1 { color: #4ade80; margin-bottom: 16px; }\n            p { color: #ddd; }\n            .spinner {\n              width: 40px;\n              height: 40px;\n              border: 4px solid rgba(255,255,255,0.3);\n              border-top: 4px solid #4ade80;\n              border-radius: 50%;\n              animation: spin 1s linear infinite;\n              margin: 20px auto;\n            }\n            @keyframes spin {\n              0% { transform: rotate(0deg); }\n              100% { transform: rotate(360deg); }\n            }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <h1>\u2705 Authentication Successful!</h1>\n            <p>Provider: <strong>${provider}</strong></p>\n            <div class=\"spinner\"></div>\n            <p>Processing... You can close this window.</p>\n          </div>\n          <script>setTimeout(() => window.close(), 3000);</script>\n        </body>\n      </html>\n    `);\n  });\n\n  return app;\n}\n\nexport function waitForCallback(\n  provider: string,\n  timeoutMs: number = 120000\n): Promise<OAuthCallbackData> {\n  return new Promise((resolve, reject) => {\n    const timer = setTimeout(() => {\n      callbackEmitter.removeAllListeners(`callback:${provider}`);\n      reject(new Error(`OAuth callback timeout for ${provider}`));\n    }, timeoutMs);\n\n    callbackEmitter.once(`callback:${provider}`, (result) => {\n      clearTimeout(timer);\n      if (result.success) {\n        resolve({ code: result.code, state: result.state });\n      } else {\n        reject(new Error(result.errorDescription || result.error || \"OAuth failed\"));\n      }\n    });\n  });\n}\n", "/**\n * Auth Hub\n * Unified authentication manager for all providers\n */\nimport { ClaudeAuthProvider } from \"./claude\";\nimport { CodexAuthProvider } from \"./codex\";\nimport { GeminiAuthProvider } from \"./gemini\";\nimport { getTokenStore } from \"../../server/store/token-store\";\nimport type {\n  AuthProvider,\n  AuthProviderName,\n  AuthResult,\n  AuthStatus,\n  LoginOptions,\n  TokenData,\n} from \"./types\";\nimport logger from \"../../shared/logger\";\n\nexport class AuthHub {\n  private providers: Map<AuthProviderName, AuthProvider>;\n  private tokenStore = getTokenStore();\n\n  constructor() {\n    this.providers = new Map<AuthProviderName, AuthProvider>([\n      [\"claude\", new ClaudeAuthProvider()],\n      [\"codex\", new CodexAuthProvider()],\n      [\"gemini\", new GeminiAuthProvider()],\n    ]);\n  }\n\n  /**\n   * Login to specific provider or interactively select\n   */\n  async login(\n    providerName?: AuthProviderName,\n    options?: LoginOptions\n  ): Promise<AuthResult[]> {\n    const results: AuthResult[] = [];\n\n    if (providerName) {\n      const provider = this.providers.get(providerName);\n      if (!provider) {\n        return [{ success: false, error: `Unknown provider: ${providerName}` }];\n      }\n      return [await provider.login(options)];\n    }\n\n    for (const [name, provider] of this.providers) {\n      const result = await provider.login(options);\n      results.push({ ...result, provider: name });\n    }\n\n    return results;\n  }\n\n  /**\n   * Get authentication status for all providers\n   */\n  async status(): Promise<AuthStatus[]> {\n    const statuses: AuthStatus[] = [];\n\n    for (const [name, provider] of this.providers) {\n      const allTokens = await this.tokenStore.retrieveAll(name);\n      \n      if (allTokens.length === 0) {\n        statuses.push({\n          provider: name,\n          displayName: provider.displayName,\n          authenticated: false,\n          accountCount: 0,\n        });\n      } else {\n        for (const tokens of allTokens) {\n          const isAuthenticated = await provider.isAuthenticated(tokens.accountId);\n          statuses.push({\n            provider: name,\n            displayName: provider.displayName,\n            authenticated: isAuthenticated,\n            type: tokens.type,\n            expiresAt: tokens.expiresAt,\n            accountId: tokens.accountId,\n            accountCount: allTokens.length,\n            needsRefresh: tokens.type === \"oauth\"\n              ? await this.tokenStore.needsRefresh(name, tokens.accountId)\n              : false,\n          });\n        }\n      }\n    }\n\n    return statuses;\n  }\n\n  /**\n   * Refresh tokens for specific provider or all\n   */\n  async refresh(providerName?: AuthProviderName, accountId?: string): Promise<AuthResult[]> {\n    const results: AuthResult[] = [];\n\n    const providers = providerName\n      ? [[providerName, this.providers.get(providerName)!]]\n      : Array.from(this.providers.entries());\n\n    for (const [name, provider] of providers as [AuthProviderName, AuthProvider][]) {\n      if (provider?.refresh) {\n        try {\n          await provider.refresh(accountId);\n          results.push({ success: true, provider: name, accountId });\n        } catch (error) {\n          results.push({\n            success: false,\n            provider: name,\n            accountId,\n            error: (error as Error).message,\n          });\n        }\n      } else {\n        results.push({\n          success: true,\n          provider: name,\n          accountId,\n        });\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Logout from specific provider or all\n   */\n  async logout(providerName?: AuthProviderName, accountId?: string): Promise<void> {\n    if (providerName) {\n      const provider = this.providers.get(providerName);\n      if (provider) {\n        await provider.logout(accountId);\n      }\n      return;\n    }\n\n    for (const provider of this.providers.values()) {\n      await provider.logout(accountId);\n    }\n  }\n\n  /**\n   * Get token for specific provider\n   */\n  async getToken(providerName: AuthProviderName, accountId?: string): Promise<string | null> {\n    const provider = this.providers.get(providerName);\n    if (!provider) return null;\n    return provider.getToken(accountId);\n  }\n\n  /**\n   * Check if specific provider is authenticated\n   */\n  async isAuthenticated(providerName: AuthProviderName, accountId?: string): Promise<boolean> {\n    const provider = this.providers.get(providerName);\n    if (!provider) return false;\n    return provider.isAuthenticated(accountId);\n  }\n\n  /**\n   * Get provider instance\n   */\n  getProvider(providerName: AuthProviderName): AuthProvider | undefined {\n    return this.providers.get(providerName);\n  }\n\n  /**\n   * Map model provider to auth provider name\n   */\n  mapModelProviderToAuth(modelProvider: string): AuthProviderName | null {\n    const mapping: Record<string, AuthProviderName> = {\n      anthropic: \"claude\",\n      openai: \"codex\",\n      google: \"gemini\",\n    };\n    return mapping[modelProvider] || null;\n  }\n}\n\n// Singleton instance\nlet authHubInstance: AuthHub | null = null;\n\nexport function getAuthHub(): AuthHub {\n  if (!authHubInstance) {\n    authHubInstance = new AuthHub();\n  }\n  return authHubInstance;\n}\n", "import { Command } from \"commander\";\nimport type { SuperCoinConfig } from \"../../config/schema\";\nimport { getModelRouter } from \"../../services/models/router\";\nimport type { ModelInfo as ModelInfoType } from \"../../services/models/types\";\n\nfunction formatContextWindow(tokens: number): string {\n  if (tokens >= 1000000) {\n    return `${tokens / 1000000}M`;\n  }\n  return `${tokens / 1000}K`;\n}\n\nexport function createModelsCommand(config: SuperCoinConfig): Command {\n  const models = new Command(\"models\")\n    .description(\"Manage AI models\");\n\n  models\n    .command(\"list\")\n    .description(\"List all available models\")\n    .option(\"--provider <provider>\", \"Filter by provider\")\n    .option(\"--json\", \"Output as JSON\")\n    .action(async (options) => {\n      const router = getModelRouter({\n        defaultModel: config.default_model,\n        fallbackModels: config.fallback_models,\n      });\n\n      let modelList: ModelInfoType[] = router.listModels();\n\n      if (options.provider) {\n        modelList = modelList.filter((m) => m.provider === options.provider);\n      }\n\n      if (options.json) {\n        console.log(JSON.stringify(modelList, null, 2));\n        return;\n      }\n\n      console.log(\"\\nAvailable Models:\\n\");\n      console.log(\"+----------------------------------+-----------+-------------+--------------+\");\n      console.log(\"| Model ID                         | Provider  | Context     | Input Cost   |\");\n      console.log(\"+----------------------------------+-----------+-------------+--------------+\");\n\n      for (const model of modelList) {\n        const id = model.id.padEnd(32);\n        const provider = model.provider.padEnd(9);\n        const context = formatContextWindow(model.contextWindow).padEnd(11);\n        const cost = `$${model.pricing.input.toFixed(2)}/M`.padEnd(12);\n\n        console.log(`| ${id} | ${provider} | ${context} | ${cost} |`);\n      }\n\n      console.log(\"+----------------------------------+-----------+-------------+--------------+\");\n    });\n\n  models\n    .command(\"info <modelId>\")\n    .description(\"Get detailed information about a model\")\n    .action(async (modelId: string) => {\n      const router = getModelRouter({\n        defaultModel: config.default_model,\n        fallbackModels: config.fallback_models,\n      });\n\n      const model = router.getModelInfo(modelId);\n\n      if (!model) {\n        console.error(`Model not found: ${modelId}`);\n        console.log(\"\\nAvailable models:\");\n        router.listModels().forEach((m) => console.log(`  - ${m.id}`));\n        process.exit(1);\n      }\n\n      console.log(`\\nModel: ${model.name}`);\n      console.log(`ID: ${model.id}`);\n      console.log(`Provider: ${model.provider}`);\n      console.log(`Context Window: ${formatContextWindow(model.contextWindow)}`);\n      console.log(`Capabilities: ${model.capabilities.join(\", \")}`);\n      console.log(`Pricing:`);\n      console.log(`  Input: $${model.pricing.input.toFixed(2)} per 1M tokens`);\n      console.log(`  Output: $${model.pricing.output.toFixed(2)} per 1M tokens`);\n    });\n\n  models\n    .command(\"set-default <modelId>\")\n    .description(\"Set the default model\")\n    .action(async (modelId: string) => {\n      const router = getModelRouter({\n        defaultModel: config.default_model,\n        fallbackModels: config.fallback_models,\n      });\n\n      try {\n        await router.setModel(modelId);\n        const current = router.getCurrentModel();\n        console.log(`Default model set to: ${current.provider}/${current.model}`);\n      } catch (error) {\n        console.error(`Error: ${(error as Error).message}`);\n        process.exit(1);\n      }\n    });\n\n  models\n    .command(\"current\")\n    .description(\"Show the current default model\")\n    .action(() => {\n      const router = getModelRouter({\n        defaultModel: config.default_model,\n        fallbackModels: config.fallback_models,\n      });\n\n      const current = router.getCurrentModel();\n      console.log(`Current model: ${current.provider}/${current.model}`);\n    });\n\n  return models;\n}\n", "/**\n * Custom Error Classes\n */\n\nexport class SuperCoinError extends Error {\n  public readonly code: string;\n  public readonly details?: unknown;\n\n  constructor(message: string, code: string, details?: unknown) {\n    super(message);\n    this.name = \"SuperCoinError\";\n    this.code = code;\n    this.details = details;\n  }\n}\n\nexport class AuthError extends SuperCoinError {\n  constructor(message: string, provider?: string) {\n    super(message, \"AUTH_ERROR\", { provider });\n    this.name = \"AuthError\";\n  }\n}\n\nexport class ModelError extends SuperCoinError {\n  constructor(message: string, model?: string) {\n    super(message, \"MODEL_ERROR\", { model });\n    this.name = \"ModelError\";\n  }\n}\n\nexport class ConfigError extends SuperCoinError {\n  constructor(message: string, path?: string) {\n    super(message, \"CONFIG_ERROR\", { path });\n    this.name = \"ConfigError\";\n  }\n}\n\nexport class NetworkError extends SuperCoinError {\n  constructor(message: string, url?: string) {\n    super(message, \"NETWORK_ERROR\", { url });\n    this.name = \"NetworkError\";\n  }\n}\n\nexport class AgentError extends SuperCoinError {\n  constructor(message: string, agent?: string) {\n    super(message, \"AGENT_ERROR\", { agent });\n    this.name = \"AgentError\";\n  }\n}\n", "import type {\n  Provider,\n  ModelDefinition,\n  AIRequest,\n  AIResponse,\n  ModelConfig,\n  Message,\n  ToolDefinition,\n} from \"../types\";\nimport { NetworkError } from \"../../../shared/errors\";\nimport logger from \"../../../shared/logger\";\n\ninterface AnthropicMessage {\n  role: \"user\" | \"assistant\";\n  content: string | AnthropicContentBlock[];\n}\n\ninterface AnthropicContentBlock {\n  type: \"text\" | \"tool_use\";\n  text?: string;\n  id?: string;\n  name?: string;\n  input?: Record<string, unknown>;\n}\n\ninterface AnthropicTool {\n  name: string;\n  description: string;\n  input_schema: Record<string, unknown>;\n}\n\ninterface AnthropicResponse {\n  content: AnthropicContentBlock[];\n  usage: {\n    input_tokens: number;\n    output_tokens: number;\n  };\n  stop_reason: string;\n}\n\nexport class AnthropicProvider implements Provider {\n  readonly name = \"anthropic\" as const;\n  private readonly baseUrl = \"https://api.anthropic.com/v1\";\n\n  private readonly models: ModelDefinition[] = [\n    {\n      id: \"claude-opus-4-5\",\n      name: \"Claude Opus 4.5\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\"],\n      pricing: { input: 15.0, output: 75.0 },\n    },\n    {\n      id: \"claude-sonnet-4-5\",\n      name: \"Claude Sonnet 4.5\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\"],\n      pricing: { input: 3.0, output: 15.0 },\n    },\n    {\n      id: \"claude-haiku-4-5\",\n      name: \"Claude Haiku 4.5\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\"],\n      pricing: { input: 0.8, output: 4.0 },\n    },\n    {\n      id: \"claude-sonnet-4\",\n      name: \"Claude Sonnet 4\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\"],\n      pricing: { input: 3.0, output: 15.0 },\n    },\n    {\n      id: \"claude-haiku-3-5\",\n      name: \"Claude Haiku 3.5\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\"],\n      pricing: { input: 0.8, output: 4.0 },\n    },\n  ];\n\n  isValidModel(model: string): boolean {\n    return this.models.some((m) => m.id === model);\n  }\n\n  listModels(): ModelDefinition[] {\n    return this.models;\n  }\n\n  getModelInfo(model: string): ModelDefinition | null {\n    return this.models.find((m) => m.id === model) || null;\n  }\n\n  async complete(\n    request: AIRequest,\n    config: ModelConfig,\n    token: string\n  ): Promise<AIResponse> {\n    const response = await fetch(`${this.baseUrl}/messages`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"x-api-key\": token,\n        \"anthropic-version\": \"2023-06-01\",\n      },\n      body: JSON.stringify({\n        model: config.model,\n        max_tokens: config.maxTokens || 4096,\n        temperature: config.temperature ?? 0.7,\n        system: request.systemPrompt,\n        messages: this.convertMessages(request.messages),\n        tools: request.tools ? this.convertTools(request.tools) : undefined,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json() as { error?: { message?: string } };\n      const message = error.error?.message || response.statusText;\n      logger.error(`Anthropic API request failed`, new Error(message));\n      throw new NetworkError(`Anthropic API error: ${message}`, \"https://api.anthropic.com\");\n    }\n\n    const data = await response.json() as AnthropicResponse;\n    return this.convertResponse(data, config.model);\n  }\n\n  private convertMessages(messages: Message[]): AnthropicMessage[] {\n    return messages\n      .filter((m) => m.role !== \"system\")\n      .map((m) => ({\n        role: m.role as \"user\" | \"assistant\",\n        content: m.content,\n      }));\n  }\n\n  private convertTools(tools: ToolDefinition[]): AnthropicTool[] {\n    return tools.map((t) => ({\n      name: t.name,\n      description: t.description,\n      input_schema: t.parameters,\n    }));\n  }\n\n  private convertResponse(data: AnthropicResponse, model: string): AIResponse {\n    const textContent = data.content.find((c) => c.type === \"text\");\n    const toolUseContent = data.content.filter((c) => c.type === \"tool_use\");\n\n    return {\n      content: textContent?.text || \"\",\n      toolCalls: toolUseContent.map((t) => ({\n        id: t.id || \"\",\n        name: t.name || \"\",\n        arguments: t.input || {},\n      })),\n      usage: {\n        promptTokens: data.usage.input_tokens,\n        completionTokens: data.usage.output_tokens,\n        totalTokens: data.usage.input_tokens + data.usage.output_tokens,\n      },\n      model,\n      finishReason: data.stop_reason === \"end_turn\" ? \"stop\" : \"tool_calls\",\n    };\n  }\n}\n", "import type {\n  Provider,\n  ModelDefinition,\n  AIRequest,\n  AIResponse,\n  ModelConfig,\n  Message,\n  ToolDefinition,\n} from \"../types\";\nimport { NetworkError } from \"../../../shared/errors\";\nimport logger from \"../../../shared/logger\";\n\ninterface OpenAIMessage {\n  role: \"user\" | \"assistant\" | \"system\";\n  content: string;\n}\n\ninterface OpenAITool {\n  type: \"function\";\n  function: {\n    name: string;\n    description: string;\n    parameters: Record<string, unknown>;\n  };\n}\n\ninterface OpenAIToolCall {\n  id: string;\n  function: {\n    name: string;\n    arguments: string;\n  };\n}\n\ninterface OpenAIResponse {\n  choices: Array<{\n    message: {\n      content: string | null;\n      tool_calls?: OpenAIToolCall[];\n    };\n    finish_reason: string;\n  }>;\n  usage: {\n    prompt_tokens: number;\n    completion_tokens: number;\n    total_tokens: number;\n  };\n}\n\nexport class OpenAIProvider implements Provider {\n  readonly name = \"openai\" as const;\n  private readonly baseUrl = \"https://api.openai.com/v1\";\n\n  private readonly models: ModelDefinition[] = [\n    {\n      id: \"gpt-5.2\",\n      name: \"GPT-5.2\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\", \"reasoning\"],\n      pricing: { input: 5.0, output: 15.0 },\n    },\n    {\n      id: \"o3\",\n      name: \"o3\",\n      contextWindow: 200000,\n      capabilities: [\"chat\", \"reasoning\"],\n      pricing: { input: 15.0, output: 60.0 },\n    },\n    {\n      id: \"o1\",\n      name: \"o1\",\n      contextWindow: 128000,\n      capabilities: [\"chat\", \"reasoning\"],\n      pricing: { input: 15.0, output: 60.0 },\n    },\n    {\n      id: \"o1-mini\",\n      name: \"o1-mini\",\n      contextWindow: 128000,\n      capabilities: [\"chat\", \"reasoning\", \"coding\"],\n      pricing: { input: 3.0, output: 12.0 },\n    },\n    {\n      id: \"gpt-4o\",\n      name: \"GPT-4o\",\n      contextWindow: 128000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\"],\n      pricing: { input: 2.5, output: 10.0 },\n    },\n  ];\n\n  isValidModel(model: string): boolean {\n    return this.models.some((m) => m.id === model);\n  }\n\n  listModels(): ModelDefinition[] {\n    return this.models;\n  }\n\n  getModelInfo(model: string): ModelDefinition | null {\n    return this.models.find((m) => m.id === model) || null;\n  }\n\n  async complete(\n    request: AIRequest,\n    config: ModelConfig,\n    token: string\n  ): Promise<AIResponse> {\n    const response = await fetch(`${this.baseUrl}/chat/completions`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify({\n        model: config.model,\n        messages: this.convertMessages(request.messages, request.systemPrompt),\n        max_tokens: config.maxTokens || 4096,\n        temperature: config.temperature ?? 0.7,\n        tools: request.tools ? this.convertTools(request.tools) : undefined,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json() as { error?: { message?: string } };\n      const message = error.error?.message || response.statusText;\n      logger.error(`OpenAI API request failed`, new Error(message));\n      throw new NetworkError(`OpenAI API error: ${message}`, \"https://api.openai.com\");\n    }\n\n    const data = await response.json() as OpenAIResponse;\n    return this.convertResponse(data, config.model);\n  }\n\n  private convertMessages(messages: Message[], systemPrompt?: string): OpenAIMessage[] {\n    const converted: OpenAIMessage[] = [];\n\n    if (systemPrompt) {\n      converted.push({ role: \"system\", content: systemPrompt });\n    }\n\n    for (const m of messages) {\n      converted.push({ role: m.role, content: m.content });\n    }\n\n    return converted;\n  }\n\n  private convertTools(tools: ToolDefinition[]): OpenAITool[] {\n    return tools.map((t) => ({\n      type: \"function\" as const,\n      function: {\n        name: t.name,\n        description: t.description,\n        parameters: t.parameters,\n      },\n    }));\n  }\n\n  private convertResponse(data: OpenAIResponse, model: string): AIResponse {\n    const choice = data.choices[0];\n    const message = choice.message;\n\n    return {\n      content: message.content || \"\",\n      toolCalls: message.tool_calls?.map((t) => ({\n        id: t.id,\n        name: t.function.name,\n        arguments: JSON.parse(t.function.arguments),\n      })),\n      usage: {\n        promptTokens: data.usage.prompt_tokens,\n        completionTokens: data.usage.completion_tokens,\n        totalTokens: data.usage.total_tokens,\n      },\n      model,\n      finishReason: choice.finish_reason === \"stop\" ? \"stop\" : \"tool_calls\",\n    };\n  }\n}\n", "import type {\n  Provider,\n  ModelDefinition,\n  AIRequest,\n  AIResponse,\n  ModelConfig,\n  Message,\n  ToolDefinition,\n} from \"../types\";\nimport { NetworkError } from \"../../../shared/errors\";\nimport logger from \"../../../shared/logger\";\n\ninterface GeminiContent {\n  role: \"user\" | \"model\";\n  parts: Array<{ text: string }>;\n}\n\ninterface GeminiTool {\n  functionDeclarations: Array<{\n    name: string;\n    description: string;\n    parameters: Record<string, unknown>;\n  }>;\n}\n\ninterface GeminiFunctionCall {\n  functionCall: {\n    name: string;\n    args: Record<string, unknown>;\n  };\n}\n\ninterface GeminiResponse {\n  candidates: Array<{\n    content: {\n      parts: Array<{ text?: string; functionCall?: { name: string; args: Record<string, unknown> } }>;\n    };\n    finishReason: string;\n  }>;\n  usageMetadata?: {\n    promptTokenCount: number;\n    candidatesTokenCount: number;\n    totalTokenCount: number;\n  };\n}\n\nexport class GoogleProvider implements Provider {\n  readonly name = \"google\" as const;\n  private readonly baseUrl = \"https://generativelanguage.googleapis.com/v1beta\";\n\n  private readonly models: ModelDefinition[] = [\n    {\n      id: \"gemini-3-pro\",\n      name: \"Gemini 3 Pro\",\n      contextWindow: 2000000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\", \"long_context\"],\n      pricing: { input: 1.25, output: 5.0 },\n    },\n    {\n      id: \"gemini-3-flash\",\n      name: \"Gemini 3 Flash\",\n      contextWindow: 1000000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\", \"long_context\"],\n      pricing: { input: 0.075, output: 0.3 },\n    },\n    {\n      id: \"gemini-2.0-flash\",\n      name: \"Gemini 2.0 Flash\",\n      contextWindow: 1000000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\", \"long_context\"],\n      pricing: { input: 0.075, output: 0.3 },\n    },\n    {\n      id: \"gemini-2.0-pro\",\n      name: \"Gemini 2.0 Pro\",\n      contextWindow: 1000000,\n      capabilities: [\"chat\", \"vision\", \"function_calling\", \"long_context\"],\n      pricing: { input: 1.25, output: 5.0 },\n    },\n  ];\n\n  isValidModel(model: string): boolean {\n    return this.models.some((m) => m.id === model);\n  }\n\n  listModels(): ModelDefinition[] {\n    return this.models;\n  }\n\n  getModelInfo(model: string): ModelDefinition | null {\n    return this.models.find((m) => m.id === model) || null;\n  }\n\n  async complete(\n    request: AIRequest,\n    config: ModelConfig,\n    token: string\n  ): Promise<AIResponse> {\n    const modelPath = `models/${config.model}`;\n    const url = `${this.baseUrl}/${modelPath}:generateContent?key=${token}`;\n\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        contents: this.convertMessages(request.messages),\n        systemInstruction: request.systemPrompt\n          ? { parts: [{ text: request.systemPrompt }] }\n          : undefined,\n        generationConfig: {\n          maxOutputTokens: config.maxTokens || 8192,\n          temperature: config.temperature ?? 0.7,\n        },\n        tools: request.tools ? this.convertTools(request.tools) : undefined,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json() as { error?: { message?: string } };\n      const message = error.error?.message || response.statusText;\n      logger.error(`Google AI API request failed`, new Error(message));\n      throw new NetworkError(`Google AI API error: ${message}`, \"https://generativelanguage.googleapis.com\");\n    }\n\n    const data = await response.json() as GeminiResponse;\n    return this.convertResponse(data, config.model);\n  }\n\n  private convertMessages(messages: Message[]): GeminiContent[] {\n    return messages\n      .filter((m) => m.role !== \"system\")\n      .map((m) => ({\n        role: m.role === \"assistant\" ? \"model\" as const : \"user\" as const,\n        parts: [{ text: m.content }],\n      }));\n  }\n\n  private convertTools(tools: ToolDefinition[]): GeminiTool[] {\n    return [\n      {\n        functionDeclarations: tools.map((t) => ({\n          name: t.name,\n          description: t.description,\n          parameters: t.parameters,\n        })),\n      },\n    ];\n  }\n\n  private convertResponse(data: GeminiResponse, model: string): AIResponse {\n    const candidate = data.candidates[0];\n    const content = candidate.content;\n    const textPart = content.parts.find((p) => p.text);\n    const functionCalls = content.parts.filter((p) => p.functionCall);\n\n    return {\n      content: textPart?.text || \"\",\n      toolCalls: functionCalls.map((fc) => ({\n        id: crypto.randomUUID(),\n        name: fc.functionCall!.name,\n        arguments: fc.functionCall!.args,\n      })),\n      usage: {\n        promptTokens: data.usageMetadata?.promptTokenCount || 0,\n        completionTokens: data.usageMetadata?.candidatesTokenCount || 0,\n        totalTokens: data.usageMetadata?.totalTokenCount || 0,\n      },\n      model,\n      finishReason:\n        candidate.finishReason === \"STOP\"\n          ? \"stop\"\n          : candidate.finishReason === \"FUNCTION_CALL\"\n          ? \"tool_calls\"\n          : \"stop\",\n    };\n  }\n}\n", "import { getAuthHub } from \"../auth/hub\";\nimport type { AuthProviderName } from \"../auth/types\";\nimport { AnthropicProvider, OpenAIProvider, GoogleProvider } from \"./providers\";\nimport type {\n  Provider,\n  ProviderName,\n  ModelConfig,\n  ModelInfo,\n  AIRequest,\n  AIResponse,\n  RouterConfig,\n} from \"./types\";\nimport logger from \"../../shared/logger\";\n\nexport class ModelRouter {\n  private providers: Map<ProviderName, Provider>;\n  private currentModel: ModelConfig;\n  private fallbackChain: string[];\n  private modelAliases: Map<string, string>;\n\n  constructor(config: RouterConfig) {\n    this.providers = new Map<ProviderName, Provider>([\n      [\"anthropic\", new AnthropicProvider()],\n      [\"openai\", new OpenAIProvider()],\n      [\"google\", new GoogleProvider()],\n    ]);\n    this.fallbackChain = config.fallbackModels || [];\n    this.currentModel = this.parseModelId(config.defaultModel);\n    this.modelAliases = this.buildAliasMap();\n  }\n\n  async route(\n    request: AIRequest,\n    options?: { fallback?: boolean; retries?: number; timeout?: number }\n  ): Promise<AIResponse> {\n    const authHub = getAuthHub();\n    const modelConfig = this.currentModel;\n    const provider = this.providers.get(modelConfig.provider);\n\n    if (!provider) {\n      throw new Error(`Unknown provider: ${modelConfig.provider}`);\n    }\n\n    const authName = this.mapProviderToAuth(modelConfig.provider);\n    const isAuthenticated = await authHub.isAuthenticated(authName);\n    if (!isAuthenticated) {\n      throw new Error(\n        `Not authenticated with ${modelConfig.provider}. ` +\n        `Run: supercoin auth login --${authName}`\n      );\n    }\n\n    const token = await authHub.getToken(authName);\n    if (!token) {\n      throw new Error(`No token available for ${modelConfig.provider}`);\n    }\n\n    try {\n      return await this.executeWithRetry(\n        () => provider.complete(request, modelConfig, token),\n        options?.retries || 3,\n        options?.timeout || 60000\n      );\n    } catch (error) {\n      if (options?.fallback !== false && this.shouldFallback(error as Error)) {\n        return await this.fallbackRoute(request, options);\n      }\n      throw error;\n    }\n  }\n\n  async setModel(modelId: string): Promise<void> {\n    const authHub = getAuthHub();\n    const resolvedId = this.resolveAlias(modelId);\n    const modelConfig = this.parseModelId(resolvedId);\n\n    const provider = this.providers.get(modelConfig.provider);\n    if (!provider) {\n      throw new Error(`Unknown provider: ${modelConfig.provider}`);\n    }\n\n    const isValidModel = provider.isValidModel(modelConfig.model);\n    if (!isValidModel) {\n      const models = provider.listModels().map((m) => m.id);\n      throw new Error(\n        `Unknown model: ${modelConfig.model}. ` +\n        `Available models for ${modelConfig.provider}: ${models.join(\", \")}`\n      );\n    }\n\n    const authName = this.mapProviderToAuth(modelConfig.provider);\n    const isAuthenticated = await authHub.isAuthenticated(authName);\n    if (!isAuthenticated) {\n      throw new Error(\n        `Not authenticated with ${modelConfig.provider}. ` +\n        `Run: supercoin auth login --${authName}`\n      );\n    }\n\n    this.currentModel = modelConfig;\n  }\n\n  getCurrentModel(): ModelConfig {\n    return { ...this.currentModel };\n  }\n\n  listModels(): ModelInfo[] {\n    const models: ModelInfo[] = [];\n\n    for (const [providerName, provider] of this.providers) {\n      for (const model of provider.listModels()) {\n        models.push({\n          ...model,\n          id: `${providerName}/${model.id}`,\n          provider: providerName,\n        });\n      }\n    }\n\n    return models;\n  }\n\n  getModelInfo(modelId: string): ModelInfo | null {\n    try {\n      const resolvedId = this.resolveAlias(modelId);\n      const parsed = this.tryParseModelId(resolvedId);\n      if (!parsed) return null;\n\n      const { provider: providerName, model } = parsed;\n      const provider = this.providers.get(providerName);\n\n      if (!provider) return null;\n\n      const modelInfo = provider.getModelInfo(model);\n      if (!modelInfo) return null;\n\n      return {\n        ...modelInfo,\n        id: `${providerName}/${model}`,\n        provider: providerName,\n      };\n    } catch {\n      return null;\n    }\n  }\n\n  private tryParseModelId(modelId: string): ModelConfig | null {\n    const parts = modelId.split(\"/\");\n    if (parts.length !== 2) {\n      return null;\n    }\n    return { provider: parts[0] as ProviderName, model: parts[1] };\n  }\n\n  private async fallbackRoute(\n    request: AIRequest,\n    options?: { fallback?: boolean; retries?: number; timeout?: number }\n  ): Promise<AIResponse> {\n    const authHub = getAuthHub();\n\n    for (const modelId of this.fallbackChain) {\n      const modelConfig = this.parseModelId(modelId);\n      const provider = this.providers.get(modelConfig.provider);\n\n      if (!provider) continue;\n\n      const authName = this.mapProviderToAuth(modelConfig.provider);\n      const isAuthenticated = await authHub.isAuthenticated(authName);\n      if (!isAuthenticated) continue;\n\n      try {\n        const token = await authHub.getToken(authName);\n        if (!token) continue;\n\n        logger.info(`Falling back to ${modelId}...`);\n        return await provider.complete(request, modelConfig, token);\n      } catch {\n        continue;\n      }\n    }\n\n    throw new Error(\"All fallback models failed\");\n  }\n\n  private parseModelId(modelId: string): ModelConfig {\n    const parts = modelId.split(\"/\");\n    if (parts.length !== 2) {\n      throw new Error(`Invalid model ID format: ${modelId}. Expected: provider/model`);\n    }\n    return { provider: parts[0] as ProviderName, model: parts[1] };\n  }\n\n  private resolveAlias(modelId: string): string {\n    if (this.modelAliases.has(modelId)) {\n      return this.modelAliases.get(modelId)!;\n    }\n    return modelId;\n  }\n\n  private buildAliasMap(): Map<string, string> {\n    return new Map([\n      [\"claude-opus\", \"anthropic/claude-opus-4-5\"],\n      [\"opus\", \"anthropic/claude-opus-4-5\"],\n      [\"claude-sonnet\", \"anthropic/claude-sonnet-4-5\"],\n      [\"sonnet\", \"anthropic/claude-sonnet-4-5\"],\n      [\"claude-haiku\", \"anthropic/claude-haiku-4-5\"],\n      [\"haiku\", \"anthropic/claude-haiku-4-5\"],\n      [\"claude\", \"anthropic/claude-sonnet-4-5\"],\n\n      [\"gpt-5.2\", \"openai/gpt-5.2\"],\n      [\"gpt-5\", \"openai/gpt-5.2\"],\n      [\"gpt-4o\", \"openai/gpt-4o\"],\n      [\"4o\", \"openai/gpt-4o\"],\n      [\"gpt\", \"openai/gpt-5.2\"],\n      [\"o1\", \"openai/o1\"],\n      [\"o1-mini\", \"openai/o1-mini\"],\n      [\"o3\", \"openai/o3\"],\n\n      [\"gemini-flash\", \"google/gemini-3-flash\"],\n      [\"flash\", \"google/gemini-3-flash\"],\n      [\"gemini-pro\", \"google/gemini-3-pro\"],\n      [\"gemini\", \"google/gemini-3-flash\"],\n    ]);\n  }\n\n  private mapProviderToAuth(provider: ProviderName): AuthProviderName {\n    const map: Record<ProviderName, AuthProviderName> = {\n      anthropic: \"claude\",\n      openai: \"codex\",\n      google: \"gemini\",\n    };\n    return map[provider];\n  }\n\n  private shouldFallback(error: Error): boolean {\n    const fallbackErrors = [\n      \"rate_limit_exceeded\",\n      \"model_overloaded\",\n      \"server_error\",\n      \"timeout\",\n    ];\n    return fallbackErrors.some((e) => error.message?.includes(e));\n  }\n\n  private async executeWithRetry<T>(\n    fn: () => Promise<T>,\n    retries: number,\n    timeout: number\n  ): Promise<T> {\n    let lastError: Error = new Error(\"Unknown error\");\n\n    for (let i = 0; i < retries; i++) {\n      try {\n        return await Promise.race([\n          fn(),\n          new Promise<never>((_, reject) =>\n            setTimeout(() => reject(new Error(\"timeout\")), timeout)\n          ),\n        ]);\n      } catch (error) {\n        lastError = error as Error;\n        if (i < retries - 1) {\n          await this.delay(Math.pow(2, i) * 1000);\n        }\n      }\n    }\n\n    throw lastError;\n  }\n\n  private delay(ms: number): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n\nlet routerInstance: ModelRouter | null = null;\n\nexport function getModelRouter(config?: RouterConfig): ModelRouter {\n  if (!routerInstance || config) {\n    const defaultConfig: RouterConfig = config || {\n      defaultModel: \"anthropic/claude-sonnet-4-5\",\n      fallbackModels: [\"openai/gpt-5.2\", \"google/gemini-3-flash\"],\n    };\n    routerInstance = new ModelRouter(defaultConfig);\n  }\n  return routerInstance;\n}\n\nexport function resetModelRouter(): void {\n  routerInstance = null;\n}\n", "import { Command } from \"commander\";\nimport type { SuperCoinConfig } from \"../../config/schema\";\nimport { startServer, stopServer, getServerStatus, isServerRunning } from \"../../server\";\nimport logger from \"../../shared/logger\";\n\nexport function createServerCommand(config: SuperCoinConfig): Command {\n  const server = new Command(\"server\")\n    .description(\"Manage local authentication server\");\n\n  server\n    .command(\"start\")\n    .description(\"Start the local server\")\n    .option(\"--port <number>\", \"Port number\", parseInt)\n    .option(\"--host <host>\", \"Host address\")\n    .option(\"--foreground\", \"Run in foreground\")\n    .action(async (options) => {\n      const port = options.port || config.server?.port || 3100;\n      const host = options.host || config.server?.host || \"127.0.0.1\";\n\n      if (isServerRunning()) {\n        const status = getServerStatus();\n        logger.info(`Server already running at http://${status.host}:${status.port}`);\n        return;\n      }\n\n      try {\n        const status = await startServer({ port, host });\n        logger.success(`Server started at http://${status.host}:${status.port}`);\n\n        if (options.foreground) {\n          logger.info(\"Running in foreground mode. Press Ctrl+C to stop.\");\n          await new Promise(() => {});\n        } else {\n          logger.info(\"Server running in background\");\n        }\n      } catch (error) {\n        logger.error(\"Failed to start server\", error as Error);\n        process.exit(1);\n      }\n    });\n\n  server\n    .command(\"stop\")\n    .description(\"Stop the local server\")\n    .action(async () => {\n      if (!isServerRunning()) {\n        logger.info(\"Server is not running\");\n        return;\n      }\n\n      try {\n        await stopServer();\n        logger.success(\"Server stopped\");\n      } catch (error) {\n        logger.error(\"Failed to stop server\", error as Error);\n        process.exit(1);\n      }\n    });\n\n  server\n    .command(\"status\")\n    .description(\"Show server status\")\n    .action(async () => {\n      const status = getServerStatus();\n\n      console.log(\"\\nServer Status:\");\n      if (status.running) {\n        console.log(`  Status: Running`);\n        console.log(`  Address: http://${status.host}:${status.port}`);\n        console.log(`  PID: ${status.pid}`);\n        console.log(`  Uptime: ${formatUptime(status.uptime || 0)}`);\n      } else {\n        console.log(`  Status: Not running`);\n        const port = config.server?.port || 3100;\n        const host = config.server?.host || \"127.0.0.1\";\n        console.log(`  Configured: http://${host}:${port}`);\n      }\n      console.log();\n    });\n\n  server\n    .command(\"logs\")\n    .description(\"Show server logs\")\n    .option(\"-f, --follow\", \"Follow log output\")\n    .option(\"-n, --lines <number>\", \"Number of lines\", parseInt)\n    .action(async (_options) => {\n      logger.info(\"Server logs are printed to stdout when running in foreground mode\");\n    });\n\n  server\n    .command(\"config\")\n    .description(\"Manage server configuration\")\n    .argument(\"<action>\", \"Action: get, set, list\")\n    .argument(\"[key]\", \"Configuration key\")\n    .argument(\"[value]\", \"Configuration value\")\n    .action(async (action: string, key?: string, value?: string) => {\n      switch (action) {\n        case \"list\":\n          console.log(\"\\nServer Configuration:\");\n          console.log(`  port: ${config.server?.port || 3100}`);\n          console.log(`  host: ${config.server?.host || \"127.0.0.1\"}`);\n          console.log(`  autoStart: ${config.server?.autoStart ?? true}`);\n          break;\n\n        case \"get\":\n          if (!key) {\n            console.error(\"Key is required for 'get' action\");\n            process.exit(1);\n          }\n          const serverConfig = config.server || {};\n          console.log(serverConfig[key as keyof typeof serverConfig] ?? \"undefined\");\n          break;\n\n        case \"set\":\n          if (!key || !value) {\n            console.error(\"Key and value are required for 'set' action\");\n            process.exit(1);\n          }\n          logger.info(`Would set server.${key} = ${value}`);\n          logger.warn(\"Config persistence requires editing ~/.supercoin/config.json\");\n          break;\n\n        default:\n          console.error(`Unknown action: ${action}`);\n          process.exit(1);\n      }\n    });\n\n  return server;\n}\n\nfunction formatUptime(seconds: number): string {\n  if (seconds < 60) return `${seconds}s`;\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;\n  const hours = Math.floor(seconds / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  return `${hours}h ${minutes}m`;\n}\n", "/**\n * Config Command\n * Manage SuperCoin configuration\n */\nimport { Command } from \"commander\";\nimport type { SuperCoinConfig } from \"../../config/schema\";\nimport logger from \"../../shared/logger\";\n\nexport function createConfigCommand(config: SuperCoinConfig): Command {\n  const configCmd = new Command(\"config\")\n    .description(\"Manage configuration\");\n\n  // Get config value\n  configCmd\n    .command(\"get <key>\")\n    .description(\"Get a configuration value\")\n    .action(async (key: string) => {\n      const value = getNestedValue(config, key);\n      if (value === undefined) {\n        console.log(\"undefined\");\n      } else {\n        console.log(typeof value === \"object\" ? JSON.stringify(value, null, 2) : value);\n      }\n    });\n\n  // Set config value\n  configCmd\n    .command(\"set <key> <value>\")\n    .description(\"Set a configuration value\")\n    .action(async (key: string, value: string) => {\n      logger.info(`Would set ${key} = ${value}`);\n      logger.warn(\"Config persistence will be implemented in a future phase.\");\n    });\n\n  // List all config\n  configCmd\n    .command(\"list\")\n    .description(\"List all configuration\")\n    .option(\"--json\", \"Output as JSON\")\n    .action(async (options) => {\n      if (options.json) {\n        console.log(JSON.stringify(config, null, 2));\n        return;\n      }\n\n      console.log(\"\\nConfiguration:\\n\");\n      printConfig(config);\n    });\n\n  // Reset config\n  configCmd\n    .command(\"reset\")\n    .description(\"Reset configuration to defaults\")\n    .option(\"--confirm\", \"Confirm reset\")\n    .action(async (options) => {\n      if (!options.confirm) {\n        logger.warn(\"Use --confirm to reset configuration\");\n        return;\n      }\n\n      logger.info(\"Configuration reset to defaults\");\n      logger.warn(\"Config persistence will be implemented in a future phase.\");\n    });\n\n  // Show config path\n  configCmd\n    .command(\"path\")\n    .description(\"Show configuration file paths\")\n    .action(async () => {\n      const home = process.env.HOME || process.env.USERPROFILE || \"\";\n      console.log(\"\\nConfiguration file paths (in priority order):\\n\");\n      console.log(`  1. User:    ${home}/.config/supercoin/config.json`);\n      console.log(`  2. Project: .supercoin/config.json`);\n    });\n\n  return configCmd;\n}\n\nfunction getNestedValue(obj: Record<string, unknown>, path: string): unknown {\n  const keys = path.split(\".\");\n  let value: unknown = obj;\n\n  for (const key of keys) {\n    if (value === null || value === undefined || typeof value !== \"object\") {\n      return undefined;\n    }\n    value = (value as Record<string, unknown>)[key];\n  }\n\n  return value;\n}\n\nfunction printConfig(obj: Record<string, unknown>, indent = 0): void {\n  const prefix = \"  \".repeat(indent);\n\n  for (const [key, value] of Object.entries(obj)) {\n    if (value === null || value === undefined) {\n      console.log(`${prefix}${key}: null`);\n    } else if (Array.isArray(value)) {\n      console.log(`${prefix}${key}:`);\n      value.forEach((item) => {\n        console.log(`${prefix}  - ${typeof item === \"object\" ? JSON.stringify(item) : item}`);\n      });\n    } else if (typeof value === \"object\") {\n      console.log(`${prefix}${key}:`);\n      printConfig(value as Record<string, unknown>, indent + 1);\n    } else {\n      console.log(`${prefix}${key}: ${value}`);\n    }\n  }\n}\n", "/**\n * Doctor Command\n * System diagnostics and health check\n */\nimport { Command } from \"commander\";\nimport { existsSync } from \"fs\";\nimport path from \"path\";\nimport type { SuperCoinConfig } from \"../../config/schema\";\n\ninterface CheckResult {\n  name: string;\n  status: \"pass\" | \"fail\" | \"warn\";\n  message: string;\n}\n\nexport function createDoctorCommand(config: SuperCoinConfig): Command {\n  const doctor = new Command(\"doctor\")\n    .description(\"Run system diagnostics\")\n    .option(\"--json\", \"Output as JSON\")\n    .action(async (options) => {\n      const results: CheckResult[] = [];\n\n      console.log(\"\\nSuperCoin Health Check\");\n      console.log(\"======================\\n\");\n\n      // Environment checks\n      console.log(\"[Environment]\");\n      results.push(await checkBunVersion());\n      results.push(await checkNodeVersion());\n      results.push(await checkOS());\n\n      // Authentication checks\n      console.log(\"\\n[Authentication]\");\n      results.push(await checkAuth(\"claude\", \"ANTHROPIC_API_KEY\"));\n      results.push(await checkAuth(\"codex\", \"OPENAI_API_KEY\"));\n      results.push(await checkAuth(\"gemini\", \"GOOGLE_API_KEY\"));\n\n      // Server checks\n      console.log(\"\\n[Server]\");\n      results.push(await checkServerConfig(config));\n\n      // Ollama check\n      console.log(\"\\n[Ollama]\");\n      results.push(await checkOllamaStatus());\n\n      // Config checks\n      console.log(\"\\n[Configuration]\");\n      results.push(await checkConfigFile());\n\n      // Summary\n      console.log(\"\\n---\");\n      const passed = results.filter((r) => r.status === \"pass\").length;\n      const failed = results.filter((r) => r.status === \"fail\").length;\n      const warned = results.filter((r) => r.status === \"warn\").length;\n\n      if (failed === 0) {\n        console.log(\n          `\\nAll checks passed! (${passed} passed, ${warned} warnings)`\n        );\n      } else {\n        console.log(\n          `\\n${failed} checks failed, ${warned} warnings, ${passed} passed`\n        );\n      }\n\n      if (options.json) {\n        console.log(\"\\n\" + JSON.stringify(results, null, 2));\n      }\n    });\n\n  return doctor;\n}\n\nasync function checkBunVersion(): Promise<CheckResult> {\n  if (typeof Bun !== \"undefined\") {\n    const version = Bun.version;\n    console.log(`  Bun version: v${version}`);\n    return {\n      name: \"bun_version\",\n      status: \"pass\",\n      message: `v${version}`,\n    };\n  }\n\n  console.log(\"  Bun version: Not active (Node.js runtime)\");\n  return {\n    name: \"bun_version\",\n    status: \"warn\",\n    message: \"Not active\",\n  };\n}\n\nasync function checkNodeVersion(): Promise<CheckResult> {\n  const version = process.version;\n  console.log(`  Node version: ${version}`);\n  return {\n    name: \"node_version\",\n    status: \"pass\",\n    message: version,\n  };\n}\n\nasync function checkOS(): Promise<CheckResult> {\n  const os = process.platform;\n  const arch = process.arch;\n  console.log(`  OS: ${os} (${arch})`);\n  return {\n    name: \"os\",\n    status: \"pass\",\n    message: `${os} (${arch})`,\n  };\n}\n\nasync function checkAuth(\n  provider: string,\n  envVar: string\n): Promise<CheckResult> {\n  const hasEnv = !!process.env[envVar];\n  // Verify token files if env var is missing\n  if (!hasEnv) {\n    // This is a simplified check. Ideally we'd check the token store, but that requires async access\n    // and importing the store. For now, we'll stick to env vars as the primary \"easy\" check,\n    // but we can look for token files if we want to be more thorough.\n    // However, the original code only checked env vars, so we'll stick to that for consistency\n    // unless we want to do a full token store check.\n  }\n\n  const status = hasEnv ? \"pass\" : \"warn\";\n  const icon = hasEnv ? \"[OK]\" : \"[--]\";\n  const message = hasEnv\n    ? \"Environment variable set\"\n    : \"Not configured via Env\";\n\n  console.log(`  ${provider.padEnd(8)}: ${icon} ${message}`);\n\n  return {\n    name: `auth_${provider}`,\n    status,\n    message,\n  };\n}\n\nasync function checkOllamaStatus(): Promise<CheckResult> {\n  try {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 2000);\n\n    const response = await fetch(\"http://localhost:11434/api/version\", {\n      signal: controller.signal,\n    });\n\n    clearTimeout(timeoutId);\n\n    if (response.ok) {\n      const data = (await response.json()) as { version: string };\n      console.log(`  Status    : [OK] Running v${data.version}`);\n      return {\n        name: \"ollama_status\",\n        status: \"pass\",\n        message: `Running v${data.version}`,\n      };\n    } else {\n      throw new Error(`Status ${response.status}`);\n    }\n  } catch (error) {\n    console.log(\n      `  Status    : [!!] Not running or unreachable (${\n        (error as Error).message\n      })`\n    );\n    return {\n      name: \"ollama_status\",\n      status: \"fail\", // Fail is appropriate here as it's a critical local dependency\n      message: \"Not running\",\n    };\n  }\n}\n\nasync function checkServerConfig(\n  config: SuperCoinConfig\n): Promise<CheckResult> {\n  const port = config.server?.port || 3100;\n  const host = config.server?.host || \"127.0.0.1\";\n  const url = `http://${host}:${port}/health`; // Assuming a health endpoint exists or we check root\n\n  console.log(`  Server config: http://${host}:${port}`);\n\n  try {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 1000);\n\n    // Just try to fetch root or health. If we get a response (even 404), something is listening.\n    // Ideally the server has a /health endpoint.\n    const response = await fetch(url, {\n      method: \"GET\",\n      signal: controller.signal,\n    });\n\n    clearTimeout(timeoutId);\n\n    console.log(`  Server status: [OK] Running`);\n    return {\n      name: \"server_status\",\n      status: \"pass\",\n      message: \"Running\",\n    };\n  } catch {\n    console.log(`  Server status: [--] Not running`);\n    return {\n      name: \"server_status\",\n      status: \"warn\", // Warn because it's not strictly required for CLI usage\n      message: \"Not running\",\n    };\n  }\n}\n\nasync function checkConfigFile(): Promise<CheckResult> {\n  const home = process.env.HOME || process.env.USERPROFILE || \"\";\n  const userConfig = path.join(home, \".config\", \"supercoin\", \"config.json\");\n  const projectConfig = path.join(process.cwd(), \".supercoin\", \"config.json\");\n\n  const hasUserConfig = existsSync(userConfig);\n  const hasProjectConfig = existsSync(projectConfig);\n\n  if (hasUserConfig) {\n    console.log(`  User config: Found at ${userConfig}`);\n  } else {\n    console.log(`  User config: Not found`);\n  }\n\n  if (hasProjectConfig) {\n    console.log(`  Project config: Found at ${projectConfig}`);\n  } else {\n    console.log(`  Project config: Not found`);\n  }\n\n  return {\n    name: \"config_files\",\n    status: hasUserConfig || hasProjectConfig ? \"pass\" : \"warn\",\n    message:\n      hasUserConfig || hasProjectConfig ? \"Config found\" : \"Using defaults\",\n  };\n}\n", "/**\n * Dashboard Command\n * Show agent status and progress dashboard\n */\nimport { Command } from \"commander\";\nimport * as clack from \"@clack/prompts\";\nimport type { SuperCoinConfig } from \"../../config/schema\";\nimport { getTodoManager } from \"../../services/agents/todo-manager\";\nimport { getSessionManager } from \"../../core/session\";\n\nexport function createDashboardCommand(config: SuperCoinConfig): Command {\n  const dashboard = new Command(\"dashboard\")\n    .description(\"Show agent status dashboard\")\n    .option(\"--json\", \"Output as JSON\")\n    .action(async function(this: Command) {\n      const options = this.optsWithGlobals();\n      if (options.json) {\n        const todoManager = getTodoManager();\n        const todos = todoManager.list();\n        console.log(JSON.stringify({ todos }, null, 2));\n        return;\n      }\n      await runDashboard();\n    });\n\n  return dashboard;\n}\n\nasync function runDashboard() {\n  const currentSession = getSessionManager().getCurrent();\n  const todoManager = getTodoManager();\n\n  clack.intro(\"\uD83D\uDCCA SuperCoin Agent Dashboard\");\n  console.log();\n\n  // Get current todos\n  const todos = todoManager.list();\n  const pending = todoManager.listPending();\n\n  // Display todo summary\n  clack.note(`Todo Progress (${pending.length} pending)`, \"Summary\");\n  \n  if (pending.length === 0) {\n    console.log(\"  \u2705 No pending tasks\");\n  } else {\n    pending.forEach((todo) => {\n      const statusIcon = todo.status === \"in_progress\" ? \"\uD83D\uDD04\" : \"\u25CB\";\n      const priorityBadge = todo.priority === \"high\" ? \"\uD83D\uDD34\" : todo.priority === \"medium\" ? \"\uD83D\uDFE1\" : \"\uD83D\uDFE2\";\n      console.log(`  ${statusIcon} ${priorityBadge} ${todo.content}`);\n    });\n  }\n\n  console.log();\n\n  const action = await clack.select({\n    message: \"What would you like to do?\",\n    options: [\n      { value: \"refresh\", label: \"\uD83D\uDD04 Refresh\" },\n      { value: \"exit\", label: \"\u270B Exit\" },\n    ],\n  });\n\n  if (clack.isCancel(action)) {\n    clack.cancel(\"Operation cancelled\");\n    return;\n  }\n\n  if (action === \"refresh\") {\n    await runDashboard();\n  }\n}\n", "import type { Todo, TaskStatus } from \"./types\";\n\nexport interface ITodoManager {\n  create(input: { sessionId: string; content: string; priority?: \"high\" | \"medium\" | \"low\" }): Promise<Todo>;\n  updateStatus(id: string, status: TaskStatus): Promise<void>;\n  get(id: string): Todo | undefined;\n  list(sessionId?: string): Todo[];\n  listPending(sessionId?: string): Todo[];\n  hasPending(sessionId?: string): boolean;\n  clear(sessionId?: string): void;\n  // New: Support bulk update from todowrite tool\n  setTodos(sessionId: string, todos: Todo[]): void;\n}\n\nclass TodoManager implements ITodoManager {\n  private todos: Map<string, Todo> = new Map();\n\n  async create(input: { sessionId: string; content: string; priority?: \"high\" | \"medium\" | \"low\" }): Promise<Todo> {\n    const todo: Todo = {\n      id: crypto.randomUUID(),\n      sessionId: input.sessionId,\n      content: input.content,\n      status: \"pending\",\n      priority: input.priority || \"medium\",\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    this.todos.set(todo.id, todo);\n    return todo;\n  }\n\n  async updateStatus(id: string, status: TaskStatus): Promise<void> {\n    const todo = this.todos.get(id);\n    if (todo) {\n      todo.status = status;\n      todo.updatedAt = new Date();\n    }\n  }\n\n  get(id: string): Todo | undefined {\n    return this.todos.get(id);\n  }\n\n  list(sessionId?: string): Todo[] {\n    const allTodos = Array.from(this.todos.values());\n    if (sessionId) {\n      return allTodos.filter((t) => t.sessionId === sessionId);\n    }\n    return allTodos;\n  }\n\n  listPending(sessionId?: string): Todo[] {\n    return this.list(sessionId).filter((t) => t.status === \"pending\" || t.status === \"in_progress\");\n  }\n\n  hasPending(sessionId?: string): boolean {\n    return this.listPending(sessionId).length > 0;\n  }\n\n  clear(sessionId?: string): void {\n    if (sessionId) {\n      const toDelete = this.list(sessionId).map((t) => t.id);\n      for (const id of toDelete) {\n        this.todos.delete(id);\n      }\n    } else {\n      this.todos.clear();\n    }\n  }\n\n  setTodos(sessionId: string, todos: Todo[]): void {\n    this.clear(sessionId);\n    for (const todo of todos) {\n      this.todos.set(todo.id, { ...todo, sessionId });\n    }\n  }\n}\n\nlet todoManagerInstance: TodoManager | null = null;\n\nexport function getTodoManager(): ITodoManager {\n  if (!todoManagerInstance) {\n    todoManagerInstance = new TodoManager();\n  }\n  return todoManagerInstance;\n}\n", "import type { Session, SessionMessage } from \"./types\";\n\nexport interface ISessionManager {\n  create(workdir: string, model: string): Session;\n  get(id: string): Session | undefined;\n  getCurrent(): Session | undefined;\n  setCurrent(id: string): boolean;\n  addMessage(sessionId: string, message: Omit<SessionMessage, \"timestamp\">): void;\n  getMessages(sessionId: string): SessionMessage[];\n  end(id: string): boolean;\n  list(): Session[];\n  clear(): void;\n}\n\nclass SessionManager implements ISessionManager {\n  private sessions: Map<string, Session> = new Map();\n  private currentSessionId: string | null = null;\n\n  create(workdir: string, model: string): Session {\n    const session: Session = {\n      id: crypto.randomUUID(),\n      startedAt: new Date(),\n      workdir,\n      model,\n      messages: [],\n    };\n\n    this.sessions.set(session.id, session);\n    this.currentSessionId = session.id;\n    return session;\n  }\n\n  get(id: string): Session | undefined {\n    return this.sessions.get(id);\n  }\n\n  getCurrent(): Session | undefined {\n    if (!this.currentSessionId) return undefined;\n    return this.sessions.get(this.currentSessionId);\n  }\n\n  setCurrent(id: string): boolean {\n    if (!this.sessions.has(id)) return false;\n    this.currentSessionId = id;\n    return true;\n  }\n\n  addMessage(sessionId: string, message: Omit<SessionMessage, \"timestamp\">): void {\n    const session = this.sessions.get(sessionId);\n    if (session) {\n      session.messages.push({\n        ...message,\n        timestamp: new Date(),\n      });\n    }\n  }\n\n  getMessages(sessionId: string): SessionMessage[] {\n    const session = this.sessions.get(sessionId);\n    return session?.messages || [];\n  }\n\n  end(id: string): boolean {\n    const session = this.sessions.get(id);\n    if (!session) return false;\n\n    if (this.currentSessionId === id) {\n      this.currentSessionId = null;\n    }\n\n    this.sessions.delete(id);\n    return true;\n  }\n\n  list(): Session[] {\n    return Array.from(this.sessions.values());\n  }\n\n  clear(): void {\n    this.sessions.clear();\n    this.currentSessionId = null;\n  }\n}\n\nlet sessionManagerInstance: SessionManager | null = null;\n\nexport function getSessionManager(): ISessionManager {\n  if (!sessionManagerInstance) {\n    sessionManagerInstance = new SessionManager();\n  }\n  return sessionManagerInstance;\n}\n", "import { z } from \"zod\";\nimport { readFile } from \"fs/promises\";\nimport { join } from \"path\";\nimport type { AISDKProviderName } from \"../services/models/ai-sdk/types\";\n\nconst OpenCodeConfigSchema = z.object({\n  provider: z.enum([\"anthropic\", \"openai\", \"google\", \"ollama\", \"lmstudio\", \"llamacpp\"]).default(\"ollama\"),\n  model: z.string().optional(),\n  baseURL: z.string().optional(),\n  temperature: z.number().min(0).max(2).default(0.7),\n  maxTokens: z.number().default(4096),\n  streaming: z.boolean().default(true),\n});\n\nexport type OpenCodeConfig = z.infer<typeof OpenCodeConfigSchema>;\n\nconst CONFIG_FILENAMES = [\"opencode.json\", \".opencode.json\", \"supercoin.json\"];\n\nexport async function loadOpenCodeConfig(cwd: string = process.cwd()): Promise<OpenCodeConfig> {\n  for (const filename of CONFIG_FILENAMES) {\n    try {\n      const configPath = join(cwd, filename);\n      const content = await readFile(configPath, \"utf-8\");\n      const parsed = JSON.parse(content);\n      return OpenCodeConfigSchema.parse(parsed);\n    } catch {\n      continue;\n    }\n  }\n\n  return OpenCodeConfigSchema.parse({});\n}\n\nexport function getDefaultProvider(): AISDKProviderName {\n  return \"ollama\";\n}\n\nexport function getDefaultModel(provider: AISDKProviderName): string {\n  const defaults: Record<AISDKProviderName, string> = {\n    anthropic: \"claude-sonnet-4-5\",\n    openai: \"gpt-4o\",\n    google: \"gemini-2.0-flash\",\n    ollama: \"llama3.2\",\n    lmstudio: \"local-model\",\n    llamacpp: \"local-model\",\n  };\n  return defaults[provider];\n}\n\nexport async function resolveProviderFromConfig(cwd?: string, mode: \"normal\" | \"ultrawork\" = \"normal\"): Promise<{\n  provider: AISDKProviderName;\n  model: string;\n  baseURL?: string;\n  temperature: number;\n  maxTokens: number;\n}> {\n  const config = await loadOpenCodeConfig(cwd);\n  \n  const provider = config.provider as AISDKProviderName;\n  let model = config.model || getDefaultModel(provider);\n  let temperature = config.temperature;\n  let maxTokens = config.maxTokens;\n\n  if (mode === \"ultrawork\") {\n    if (provider === \"anthropic\") model = \"claude-3-5-sonnet-latest\";\n    if (provider === \"openai\") model = \"gpt-4o\";\n    if (provider === \"google\") model = \"gemini-2.0-flash-exp\";\n    \n    temperature = 0.2;\n    maxTokens = 8192;\n  }\n\n  return {\n    provider,\n    model,\n    baseURL: config.baseURL,\n    temperature,\n    maxTokens,\n  };\n}\n", "import { createAnthropic } from \"@ai-sdk/anthropic\";\nimport { createGoogleGenerativeAI } from \"@ai-sdk/google\";\nimport { createOpenAI } from \"@ai-sdk/openai\";\nimport type { LanguageModel } from \"ai\";\nimport type {\n  AISDKProviderName,\n  AISDKProviderConfig,\n  AISDKModelConfig,\n  AISDKModelResult,\n  ProviderRegistry,\n} from \"./types\";\n\nconst PROVIDER_REGISTRY: ProviderRegistry = {\n  anthropic: {\n    name: \"Claude (Anthropic)\",\n    requiresAuth: true,\n    supportsStreaming: true,\n    defaultModel: \"claude-sonnet-4-5\",\n  },\n  openai: {\n    name: \"OpenAI\",\n    requiresAuth: true,\n    supportsStreaming: true,\n    defaultModel: \"gpt-4o\",\n  },\n  google: {\n    name: \"Gemini (Google)\",\n    requiresAuth: true,\n    supportsStreaming: true,\n    defaultModel: \"gemini-2.0-flash\",\n  },\n  ollama: {\n    name: \"Ollama (Localhost)\",\n    requiresAuth: false,\n    supportsStreaming: true,\n    defaultBaseURL: \"http://localhost:11434/v1\",\n    defaultModel: \"llama3.2\",\n  },\n  lmstudio: {\n    name: \"LM Studio (Localhost)\",\n    requiresAuth: false,\n    supportsStreaming: true,\n    defaultBaseURL: \"http://localhost:1234/v1\",\n    defaultModel: \"local-model\",\n  },\n  llamacpp: {\n    name: \"llama.cpp (Localhost)\",\n    requiresAuth: false,\n    supportsStreaming: true,\n    defaultBaseURL: \"http://localhost:8080/v1\",\n    defaultModel: \"local-model\",\n  },\n};\n\nexport function getProviderConfig(provider: AISDKProviderName): AISDKProviderConfig {\n  const config = PROVIDER_REGISTRY[provider];\n  if (!config) {\n    throw new Error(`Unknown provider: ${provider}`);\n  }\n  return config;\n}\n\nexport function isLocalhostProvider(provider: AISDKProviderName): boolean {\n  return provider === \"ollama\" || provider === \"lmstudio\" || provider === \"llamacpp\";\n}\n\nexport function createModel(config: AISDKModelConfig): AISDKModelResult {\n  const providerConfig = getProviderConfig(config.provider);\n  const model = config.model || providerConfig.defaultModel;\n\n  let languageModel: LanguageModel;\n\n  switch (config.provider) {\n    case \"anthropic\": {\n      if (!config.apiKey) {\n        throw new Error(\"API key required for Anthropic\");\n      }\n      const anthropic = createAnthropic({ apiKey: config.apiKey });\n      languageModel = anthropic(model);\n      break;\n    }\n    case \"google\": {\n      if (!config.apiKey) {\n        throw new Error(\"API key required for Google\");\n      }\n      const google = createGoogleGenerativeAI({ apiKey: config.apiKey });\n      languageModel = google(model);\n      break;\n    }\n    case \"openai\": {\n      if (!config.apiKey) {\n        throw new Error(\"API key required for OpenAI\");\n      }\n      const openai = createOpenAI({ apiKey: config.apiKey });\n      languageModel = openai(model);\n      break;\n    }\n    case \"ollama\": {\n      const baseURL = config.baseURL || providerConfig.defaultBaseURL;\n      const ollama = createOpenAI({ baseURL, apiKey: \"ollama\" });\n      languageModel = ollama.chat(model);\n      break;\n    }\n    case \"lmstudio\": {\n      const baseURL = config.baseURL || providerConfig.defaultBaseURL;\n      const lmstudio = createOpenAI({ baseURL, apiKey: \"lm-studio\" });\n      languageModel = lmstudio.chat(model);\n      break;\n    }\n    case \"llamacpp\": {\n      const baseURL = config.baseURL || providerConfig.defaultBaseURL;\n      const llamacpp = createOpenAI({ baseURL, apiKey: \"llamacpp\" });\n      languageModel = llamacpp.chat(model);\n      break;\n    }\n    default: {\n      const _exhaustive: never = config.provider;\n      throw new Error(`Unhandled provider: ${_exhaustive}`);\n    }\n  }\n\n  return {\n    model: languageModel,\n    config: providerConfig,\n  };\n}\n\nexport function listProviders(): AISDKProviderConfig[] {\n  return Object.values(PROVIDER_REGISTRY);\n}\n\nexport function listLocalhostProviders(): AISDKProviderConfig[] {\n  return Object.entries(PROVIDER_REGISTRY)\n    .filter(([key]) => isLocalhostProvider(key as AISDKProviderName))\n    .map(([, config]) => config);\n}\n\nexport { PROVIDER_REGISTRY };\n", "import { streamText } from \"ai\";\nimport { createModel, isLocalhostProvider, getProviderConfig } from \"./registry\";\nimport { TokenStore } from \"../../../server/store/token-store\";\nimport type { AISDKProviderName, StreamOptions, StreamResult } from \"./types\";\nimport type { AuthProviderName } from \"../../auth/types\";\n\nconst AUTH_PROVIDER_MAP: Record<AISDKProviderName, AuthProviderName | null> = {\n  anthropic: \"claude\",\n  openai: \"codex\",\n  google: \"gemini\",\n  ollama: null,\n  lmstudio: null,\n  llamacpp: null,\n};\n\nfunction mapToAuthProvider(provider: AISDKProviderName): AuthProviderName | null {\n  return AUTH_PROVIDER_MAP[provider];\n}\n\nasync function getApiKey(\n  provider: AISDKProviderName,\n  accountId?: string\n): Promise<string | undefined> {\n  if (isLocalhostProvider(provider)) {\n    return undefined;\n  }\n\n  const authProvider = mapToAuthProvider(provider);\n  if (!authProvider) {\n    return undefined;\n  }\n\n  const tokenStore = new TokenStore();\n  const token = await tokenStore.retrieve(authProvider, accountId);\n  \n  if (!token) {\n    throw new Error(\n      `No authentication found for ${provider}. Run: supercoin auth login ${authProvider}`\n    );\n  }\n\n  return token.accessToken;\n}\n\ntype MessageRole = \"user\" | \"assistant\" | \"system\";\n\ninterface SimpleMessage {\n  role: MessageRole;\n  content: string;\n}\n\nfunction convertMessages(\n  messages: StreamOptions[\"messages\"],\n  systemPrompt?: string\n): SimpleMessage[] {\n  const result: SimpleMessage[] = [];\n\n  if (systemPrompt) {\n    result.push({ role: \"system\", content: systemPrompt });\n  }\n\n  for (const msg of messages) {\n    result.push({\n      role: msg.role,\n      content: msg.content,\n    });\n  }\n\n  return result;\n}\n\nfunction mapFinishReason(reason: string | null | undefined): StreamResult[\"finishReason\"] {\n  switch (reason) {\n    case \"stop\":\n      return \"stop\";\n    case \"length\":\n      return \"length\";\n    case \"tool-calls\":\n      return \"tool-calls\";\n    case \"error\":\n      return \"error\";\n    default:\n      return \"other\";\n  }\n}\n\nexport async function streamAIResponse(options: StreamOptions): Promise<StreamResult> {\n  const {\n    provider,\n    model,\n    messages,\n    systemPrompt,\n    accountId,\n    baseURL,\n    temperature = 0.7,\n    maxTokens = 4096,\n    onChunk,\n    onComplete,\n    onError,\n  } = options;\n\n  try {\n    const providerConfig = getProviderConfig(provider);\n    const apiKey = await getApiKey(provider, accountId);\n\n    const { model: languageModel } = createModel({\n      provider,\n      model: model || providerConfig.defaultModel,\n      apiKey,\n      baseURL,\n    });\n\n    const convertedMessages = convertMessages(messages, systemPrompt);\n\n    const result = await streamText({\n      model: languageModel,\n      messages: convertedMessages,\n      temperature,\n      maxOutputTokens: maxTokens,\n    });\n\n    let fullText = \"\";\n\n    for await (const chunk of result.textStream) {\n      fullText += chunk;\n      onChunk?.(chunk);\n    }\n\n    onComplete?.(fullText);\n\n    const usage = await result.usage;\n    const finishReason = await result.finishReason;\n\n    return {\n      text: fullText,\n      usage: usage\n        ? {\n            promptTokens: (usage as { promptTokens?: number }).promptTokens ?? 0,\n            completionTokens: (usage as { completionTokens?: number }).completionTokens ?? 0,\n            totalTokens: ((usage as { promptTokens?: number }).promptTokens ?? 0) + \n                         ((usage as { completionTokens?: number }).completionTokens ?? 0),\n          }\n        : undefined,\n      finishReason: mapFinishReason(finishReason),\n    };\n  } catch (error) {\n    const err = error instanceof Error ? error : new Error(String(error));\n    onError?.(err);\n    throw err;\n  }\n}\n\nexport async function generateAIResponse(\n  options: Omit<StreamOptions, \"onChunk\" | \"onComplete\" | \"onError\">\n): Promise<StreamResult> {\n  return streamAIResponse({\n    ...options,\n    onChunk: undefined,\n    onComplete: undefined,\n    onError: undefined,\n  });\n}\n\nexport async function checkLocalhostAvailability(\n  provider: \"ollama\" | \"lmstudio\" | \"llamacpp\",\n  baseURL?: string\n): Promise<boolean> {\n  const config = getProviderConfig(provider);\n  const url = baseURL || config.defaultBaseURL;\n\n  if (!url) {\n    return false;\n  }\n\n  try {\n    const response = await fetch(`${url}/models`, {\n      method: \"GET\",\n      signal: AbortSignal.timeout(3000),\n    });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nexport async function listLocalhostModels(\n  provider: \"ollama\" | \"lmstudio\" | \"llamacpp\",\n  baseURL?: string\n): Promise<Array<{ id: string; name: string }>> {\n  const config = getProviderConfig(provider);\n  const url = baseURL || config.defaultBaseURL;\n\n  if (!url) {\n    return [];\n  }\n\n  try {\n    const response = await fetch(`${url}/models`, {\n      method: \"GET\",\n      signal: AbortSignal.timeout(5000),\n    });\n\n    if (!response.ok) {\n      return [];\n    }\n\n    const data = await response.json() as { data?: Array<{ id: string }> };\n    \n    return (data.data || []).map((model) => ({\n      id: model.id,\n      name: model.id,\n    }));\n  } catch {\n    return [];\n  }\n}\n"],
  "mappings": "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",
  "names": ["clack", "Command", "clack", "existsSync", "crypto", "path", "path", "existsSync", "filePath", "clack", "clack", "fs", "existsSync", "crypto", "path", "path", "existsSync", "fs", "crypto", "cancel", "createServer", "serverInfo", "Hono", "Hono", "Hono", "callbackData", "Hono", "Hono", "Command", "Command", "Command", "Command", "Command", "Command", "path", "Command", "existsSync", "path", "Command", "clack", "Command", "z", "readFile", "s", "text", "Command"]
}
